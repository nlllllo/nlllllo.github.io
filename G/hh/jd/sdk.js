!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).Watchtower=t()}(this,function(){"use strict";var T=function(e,t){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function C(e,t){function n(){this.constructor=e}T(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var f=function(){return(f=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function O(e,t){var n={};for(o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]]);return n}var k,N=!1,s={info:function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return N&&window.console&&(e=window.console).info.apply(e,t)},warn:function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return N&&window.console&&(e=window.console).warn.apply(e,t)},error:function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return N&&window.console&&(e=window.console).error.apply(e,t)},enable:function(){return N=!0}},M=(C(D,k=Error),D);function D(e){var t=this.constructor,n=k.call(this,e)||this;return n.message=e,n.name=t.prototype.constructor.name,Object.setPrototypeOf(n,t.prototype),n}A.prototype.send=function(e){throw new M("请勿直接使用 BaseTransport 上报")},A.prototype.sendVideo=function(e){throw new M("请勿直接使用 BaseTransport 上报")};var e=A;function A(e){this.endpoint=e}C(U,L=e),U.prototype.send=function(e){var t=new XMLHttpRequest;t.open("POST",this.endpoint),t.setRequestHeader("Content-Type","application/json"),t.send(JSON.stringify(f({},e)))},U.prototype.sendVideo=function(e){var t=new XMLHttpRequest;t.open("POST",this.endpoint),t.setRequestHeader("Content-Type","text/plain; charset=UTF-8"),t.send(JSON.stringify(f({},e)))},U.prototype.wtAjax=function(r){var o=this;return new Promise(function(e,t){XMLHttpRequest||t("不支持低版本浏览器哦");var n=new XMLHttpRequest;n.open("POST",o.endpoint,!0),n.setRequestHeader("Content-Type","application/json"),n.send(JSON.stringify(r)),n.onreadystatechange=function(){4===n.readyState&&(200===n.status?e(JSON.parse(n.responseText)):t(n))}})};var L,H=U;function U(){return null!==L&&L.apply(this,arguments)||this}C(W,B=e),W.prototype.send=function(e){e=new Blob([JSON.stringify(f({},e))],{type:"text/plain; charset=UTF-8"});window.navigator.sendBeacon(this.endpoint,e)},W.prototype.sendVideo=function(e){e=new Blob([JSON.stringify(f({},e))],{type:"text/plain; charset=UTF-8"});window.navigator.sendBeacon(this.endpoint,e)};var B,z=W;function W(){return null!==B&&B.apply(this,arguments)||this}e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function V(e){e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")&&e.default}function t(e,t){return e(t={exports:{}},t.exports),t.exports}var X=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),(t=t.BreadcrumbType||(t.BreadcrumbType={})).XHR="XHR",t.CONSOLE="CONSOLE",t.UI_CLICK="UI.CLICK",t.NAVIGATION="NAVIGATION",t.FETCH="FETCH"}),q=(V(X),X.BreadcrumbType,t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),(t=t.WatchtowerEventType||(t.WatchtowerEventType={})).ECMASCRIPT_ERROR="ECMASCRIPT_ERROR",t.XHR_ERROR="XHR_ERROR",t.RESOURCE_ERROR="RESOURCE_ERROR",t.JSONP_ERROR="JSONP_ERROR",t.UNHANDLEDREJECTION="UNHANDLEDREJECTION",t.LOW_FPS="LOW_FPS",t.PAGE_CRASH="PAGE_CRASH",t.DO_NOT_USE="DO_NOT_USE",t.SLOW_INTERFACE_RESPONSE="SLOW_INTERFACE_RESPONSE",t.FETCH_ERROR="FETCH_ERROR",t.CUSTOM="CUSTOM"})),n=(V(q),q.WatchtowerEventType,t(function(e,n){function t(e){for(var t in e)n.hasOwnProperty(t)||(n[t]=e[t])}Object.defineProperty(n,"__esModule",{value:!0}),t(X),t(q)})),h=(V(n),n.BreadcrumbType),m=n.WatchtowerEventType;function G(){if(function(){if("fetch"in window)try{return new Headers,new Request(""),new Response,1}catch(e){return}}())try{return-1!==window.fetch.toString().indexOf("native")}catch(e){return}}var J=function(e,t){return e===t||e!=e&&t!=t};var Y=function(e,t){for(var n=e.length;n--;)if(J(e[n][0],t))return n;return-1},$=Array.prototype.splice;function Q(e){var t=this.__data__;return!((e=Y(t,e))<0)&&(e==t.length-1?t.pop():$.call(t,e,1),--this.size,!0)}function K(e){var t=this.__data__;return(e=Y(t,e))<0?void 0:t[e][1]}function Z(e){return-1<Y(this.__data__,e)}function ee(e,t){var n=this.__data__,r=Y(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this}function te(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}te.prototype.clear=function(){this.__data__=[],this.size=0},te.prototype.delete=Q,te.prototype.get=K,te.prototype.has=Z,te.prototype.set=ee;var ne=te;function re(){this.__data__=new ne,this.size=0}function oe(e){var t=this.__data__,e=t.delete(e);return this.size=t.size,e}function de(e){return this.__data__.get(e)}function pe(e){return this.__data__.has(e)}var fe="object"==typeof e&&e&&e.Object===Object&&e,n="object"==typeof self&&self&&self.Object===Object&&self,he=fe||n||Function("return this")(),n=he.Symbol,r=Object.prototype,me=r.hasOwnProperty,ve=r.toString,ye=n?n.toStringTag:void 0;var ge=function(e){var t=me.call(e,ye),n=e[ye];try{var r=!(e[ye]=void 0)}catch(e){}var o=ve.call(e);return r&&(t?e[ye]=n:delete e[ye]),o},we=Object.prototype.toString;var be=function(e){return we.call(e)},Se=n?n.toStringTag:void 0;var _e=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":(Se&&Se in Object(e)?ge:be)(e)};var v=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)};var xe=function(e){return!!v(e)&&("[object Function]"==(e=_e(e))||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e)},r=he["__core-js_shared__"],Ee=(n=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"";var Te=function(e){return!!Ee&&Ee in e},Ce=Function.prototype.toString;var Oe=function(e){if(null!=e){try{return Ce.call(e)}catch(e){}try{return e+""}catch(e){}}return""},Re=/^\[object .+?Constructor\]$/,r=Function.prototype,n=Object.prototype,r=r.toString,n=n.hasOwnProperty,Ie=RegExp("^"+r.call(n).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var ke=function(e){return!(!v(e)||Te(e))&&(xe(e)?Ie:Re).test(Oe(e))};var Ne=function(e,t){return null==e?void 0:e[t]};var Me=function(e,t){return e=Ne(e,t),ke(e)?e:void 0},De=Me(he,"Map"),Ae=Me(Object,"create");function Le(e){return e=this.has(e)&&delete this.__data__[e],this.size-=e?1:0,e}var Fe=Object.prototype.hasOwnProperty;function Pe(e){var t,n=this.__data__;return Ae?"__lodash_hash_undefined__"===(t=n[e])?void 0:t:Fe.call(n,e)?n[e]:void 0}var je=Object.prototype.hasOwnProperty;function He(e){var t=this.__data__;return Ae?void 0!==t[e]:je.call(t,e)}function Ue(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Ae&&void 0===t?"__lodash_hash_undefined__":t,this}function Be(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Be.prototype.clear=function(){this.__data__=Ae?Ae(null):{},this.size=0},Be.prototype.delete=Le,Be.prototype.get=Pe,Be.prototype.has=He,Be.prototype.set=Ue;var ze=Be;var We=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};var Ve=function(e,t){return e=e.__data__,We(t)?e["string"==typeof t?"string":"hash"]:e.map};function Xe(e){return e=Ve(this,e).delete(e),this.size-=e?1:0,e}function qe(e){return Ve(this,e).get(e)}function Ge(e){return Ve(this,e).has(e)}function Je(e,t){var n=Ve(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this}function Ye(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Ye.prototype.clear=function(){this.size=0,this.__data__={hash:new ze,map:new(De||ne),string:new ze}},Ye.prototype.delete=Xe,Ye.prototype.get=qe,Ye.prototype.has=Ge,Ye.prototype.set=Je;var $e=Ye;function Qe(e,t){var n=this.__data__;if(n instanceof ne){var r=n.__data__;if(!De||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new $e(r)}return n.set(e,t),this.size=n.size,this}function Ke(e){e=this.__data__=new ne(e);this.size=e.size}Ke.prototype.clear=re,Ke.prototype.delete=oe,Ke.prototype.get=de,Ke.prototype.has=pe,Ke.prototype.set=Qe;var Ze=Ke,et=function(){try{var e=Me(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();var tt=function(e,t,n){"__proto__"==t&&et?et(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n};var nt=function(e,t,n){(void 0===n||J(e[t],n))&&(void 0!==n||t in e)||tt(e,t,n)};var rt=function(c){return function(e,t,n){for(var r=-1,o=Object(e),i=n(e),a=i.length;a--;){var s=i[c?a:++r];if(!1===t(o[s],s,o))break}return e}}(),ot=t(function(e,t){var t=t&&!t.nodeType&&t,n=t&&e&&!e.nodeType&&e,n=n&&n.exports===t?he.Buffer:void 0,r=n?n.allocUnsafe:void 0;e.exports=function(e,t){return t?e.slice():(t=e.length,t=r?r(t):new e.constructor(t),e.copy(t),t)}}),it=he.Uint8Array;var at=function(e){var t=new e.constructor(e.byteLength);return new it(t).set(new it(e)),t};var st=function(e,t){return t=t?at(e.buffer):e.buffer,new e.constructor(t,e.byteOffset,e.length)};var ct=function(e,t){var n=-1,r=e.length;for(t=t||Array(r);++n<r;)t[n]=e[n];return t},lt=Object.create;function ut(){}var dt=function(e){if(!v(e))return{};if(lt)return lt(e);ut.prototype=e;e=new ut;return ut.prototype=void 0,e};var r=function(t,n){return function(e){return t(n(e))}},pt=r(Object.getPrototypeOf,Object),ft=Object.prototype;var ht=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||ft)};var mt=function(e){return"function"!=typeof e.constructor||ht(e)?{}:dt(pt(e))};var vt=function(e){return null!=e&&"object"==typeof e};var n=function(e){return vt(e)&&"[object Arguments]"==_e(e)},o=Object.prototype,yt=o.hasOwnProperty,gt=o.propertyIsEnumerable,wt=n(function(){return arguments}())?n:function(e){return vt(e)&&yt.call(e,"callee")&&!gt.call(e,"callee")},bt=Array.isArray;var St=function(e){return"number"==typeof e&&-1<e&&e%1==0&&e<=9007199254740991};var _t=function(e){return null!=e&&St(e.length)&&!xe(e)};var xt=function(e){return vt(e)&&_t(e)};function Et(){return!1}var Tt=t(function(e,t){var t=t&&!t.nodeType&&t,n=t&&e&&!e.nodeType&&e,n=n&&n.exports===t?he.Buffer:void 0,t=n?n.isBuffer:void 0;e.exports=t||Et}),o=Function.prototype,n=Object.prototype,Ct=o.toString,Ot=n.hasOwnProperty,Rt=Ct.call(Object);var It=function(e){return!(!vt(e)||"[object Object]"!=_e(e))&&(null===(e=pt(e))||"function"==typeof(e=Ot.call(e,"constructor")&&e.constructor)&&e instanceof e&&Ct.call(e)==Rt)},i={};i["[object Float32Array]"]=i["[object Float64Array]"]=i["[object Int8Array]"]=i["[object Int16Array]"]=i["[object Int32Array]"]=i["[object Uint8Array]"]=i["[object Uint8ClampedArray]"]=i["[object Uint16Array]"]=i["[object Uint32Array]"]=!0,i["[object Arguments]"]=i["[object Array]"]=i["[object ArrayBuffer]"]=i["[object Boolean]"]=i["[object DataView]"]=i["[object Date]"]=i["[object Error]"]=i["[object Function]"]=i["[object Map]"]=i["[object Number]"]=i["[object Object]"]=i["[object RegExp]"]=i["[object Set]"]=i["[object String]"]=i["[object WeakMap]"]=!1;function kt(e){return vt(e)&&St(e.length)&&!!i[_e(e)]}var o=function(t){return function(e){return t(e)}},n=t(function(e,t){var t=t&&!t.nodeType&&t,n=t&&e&&!e.nodeType&&e,r=n&&n.exports===t&&fe.process,t=function(){try{var e=n&&n.require&&n.require("util").types;return e?e:r&&r.binding&&r.binding("util")}catch(e){}}();e.exports=t}),n=n&&n.isTypedArray,Nt=n?o(n):kt;var Mt=function(e,t){if("__proto__"!=t)return e[t]},Dt=Object.prototype.hasOwnProperty;var At=function(e,t,n){var r=e[t];Dt.call(e,t)&&J(r,n)&&(void 0!==n||t in e)||tt(e,t,n)};var Lt=function(e,t,n,r){for(var o=!n,i=(n=n||{},-1),a=t.length;++i<a;){var s=t[i],c=r?r(n[s],e[s],s,n,e):void 0;void 0===c&&(c=e[s]),(o?tt:At)(n,s,c)}return n};var Ft=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r},Pt=/^(?:0|[1-9]\d*)$/;var jt=function(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&Pt.test(e))&&-1<e&&e%1==0&&e<t},Ht=Object.prototype.hasOwnProperty;var Ut=function(e,t){var n,r=bt(e),o=!r&&wt(e),i=!r&&!o&&Tt(e),a=!r&&!o&&!i&&Nt(e),s=r||o||i||a,c=s?Ft(e.length,String):[],l=c.length;for(n in e)!t&&!Ht.call(e,n)||s&&("length"==n||i&&("offset"==n||"parent"==n)||a&&("buffer"==n||"byteLength"==n||"byteOffset"==n)||jt(n,l))||c.push(n);return c};var Bt=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t},zt=Object.prototype.hasOwnProperty;var Wt=function(e){if(!v(e))return Bt(e);var t,n=ht(e),r=[];for(t in e)("constructor"!=t||!n&&zt.call(e,t))&&r.push(t);return r};var Vt=function(e){return _t(e)?Ut(e,!0):Wt(e)};var Xt=function(e){return Lt(e,Vt(e))};var qt=function(e,t,n,r,o,i,a){var s,c,l,u=Mt(e,n),d=Mt(t,n),p=a.get(d);p||((t=void 0===(p=i?i(u,d,n+"",e,t,a):void 0))&&(c=!(s=bt(d))&&Tt(d),l=!s&&!c&&Nt(d),p=d,s||c||l?p=bt(u)?u:xt(u)?ct(u):c?ot(d,!(t=!1)):l?st(d,!(t=!1)):[]:It(d)||wt(d)?wt(p=u)?p=Xt(u):v(u)&&!xe(u)||(p=mt(d)):t=!1),t&&(a.set(d,p),o(p,d,r,i,a),a.delete(d))),nt(e,n,p)};var Gt=function r(o,i,a,s,c){o!==i&&rt(i,function(e,t){var n;v(e)?(c=c||new Ze,qt(o,i,t,a,r,s,c)):(n=s?s(Mt(o,t),e,t+"",o,i,c):void 0,nt(o,t,n=void 0===n?e:n))},Vt)};function Jt(e){return e}var Yt=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)},$t=Math.max;var Qt=function(i,a,s){return a=$t(void 0===a?i.length-1:a,0),function(){for(var e=arguments,t=-1,n=$t(e.length-a,0),r=Array(n);++t<n;)r[t]=e[a+t];for(var t=-1,o=Array(a+1);++t<a;)o[t]=e[t];return o[a]=s(r),Yt(i,this,o)}};var Kt=function(e){return function(){return e}},Zt=Date.now;var en=function(n){var r=0,o=0;return function(){var e=Zt(),t=16-(e-o);if(o=e,0<t){if(800<=++r)return arguments[0]}else r=0;return n.apply(void 0,arguments)}}(et?function(e,t){return et(e,"toString",{configurable:!0,enumerable:!1,value:Kt(t),writable:!0})}:Jt);var tn=function(e,t){return en(Qt(e,t,Jt),e+"")};var nn=function(e,t,n){if(!v(n))return!1;var r=typeof t;return!!("number"==r?_t(n)&&jt(t,n.length):"string"==r&&t in n)&&J(n[t],e)};var o=function(s){return tn(function(e,t){var n=-1,r=t.length,o=1<r?t[r-1]:void 0,i=2<r?t[2]:void 0,o=3<s.length&&"function"==typeof o?(r--,o):void 0;for(i&&nn(t[0],t[1],i)&&(o=r<3?void 0:o,r=1),e=Object(e);++n<r;){var a=t[n];a&&s(e,a,n,o)}return e})},rn=o(function(e,t,n){Gt(e,t,n)});function on(e){try{return e instanceof Element}catch(e){return}}function an(e){return e.match(/https?:\/\/(beta-)?api\.m\.jd\.com/)}var sn,y=function(e){return f({project:"",type:m.DO_NOT_USE,title:"",timestamp:(new Date).getTime(),sdk:{name:"watchtower-sensor-web",version:"0.0.1"},pageInfo:{url:"",extraInfo:{}},breadcrumbs:[],customKey:"",extraInfo:{}},e)},cn=/^\s*at (?:(.*?) ?\()?((?:file|https?|blob|chrome-extension|native|eval|webpack|<anonymous>|[a-z]:|\/).*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,ln=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)((?:file|https?|blob|chrome|webpack|resource|moz-extension).*?:\/.*?|\[native code\]|[^@]*bundle)(?::(\d+))?(?::(\d+))?\s*$/i,un=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:file|ms-appx|https?|webpack|blob):.*?):(\d+)(?::(\d+))?\)?\s*$/i,dn=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,pn=/\((\S*)(?::(\d+))(?::(\d+))\)/,fn="?";function hn(e,t){var n={frames:[]},r="";if(e&&e.stack){for(var o,i=e.stack.split("\n"),a=0,s=i.length,c=void 0,l=void 0;a<s;++a)(c=cn.exec(i[a]))?(o=c[2]&&0===c[2].indexOf("native"),c[2]&&0===c[2].indexOf("eval")&&(l=pn.exec(c[2]))&&(c[2]=l[1]),n.frames.push({filename:o?null:c[2],function:c[1]||fn,lineno:c[3]?+c[3]:void 0,colno:c[4]?+c[4]:void 0})):(c=un.exec(i[a]))?n.frames.push({filename:c[2],function:c[1]||fn,lineno:+c[3],colno:c[4]?+c[4]:void 0}):(c=ln.exec(i[a]))&&(c[3]&&-1<c[3].indexOf(" > eval")&&(l=dn.exec(c[3]))?c[3]=l[1]:0!==a||c[5]||void 0===e.columnNumber||(n.frames[0].colno=e.columnNumber+1),n.frames.push({filename:c[3],function:c[1]||fn,lineno:c[4]?+c[4]:void 0,colno:c[5]?+c[5]:void 0}));r=e.name+": "+e.message}else{if(!t)return null;n.frames.push({filename:t.file||"",function:fn,lineno:t.lineNo,colno:t.columnNo}),t.message&&"string"==typeof t.message&&(r=t.message.replace(/^\s*uncaught /i,""))}return y({stacktrace:n,title:r,type:m.ECMASCRIPT_ERROR})}function mn(e,t,n,r,o){i=e;var i=hn(o,{message:e="[object ErrorEvent]"===Object.prototype.toString.call(i)?e.message:e,file:t,lineNo:n,columnNo:r});i?(gn(i),sn&&sn.apply(window,[e,t,n,r,o])):s.warn("Global error was dropped: ",e,t,n,r,o)}var vn=!1,yn=[],gn=function(t){yn.forEach(function(e){return e(t)})},wn=(bn.prototype.install=function(t){s.info("GlobalHandler installed"),vn||(sn=window.onerror,window.onerror=mn,vn=!0),yn.push(function(e){t.captureEvent(e)})},bn);function bn(){}function Sn(e){if(!e)return{};var t=e.match(/^(([^:\/?#]+):)?(\/\/([^\/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!t)return{};var n=t[6]||"",r=t[8]||"",o={};return n&&(o=n.replace(/^\?/,"").split("&").reduce(function(e,t){t=t.split("=");return e[t[0]]=decodeURIComponent(t[1]||""),e},o)),{host:t[4],path:t[5],protocol:t[2],relative:t[5]+n+r,queryParams:o,baseUrl:e.replace(/\?[^\?]*/,"")}}function _n(e,t,n){var r=e[t];"function"!=typeof r||r.__watchtower__||("function"==typeof(n=n(r))&&(n.prototype=n.prototype||{},Object.defineProperties(n,{__watchtower__:{enumerable:!1,value:!0},__watchtower_original__:{enumerable:!1,value:r}})),e[t]=n)}En.prototype.install=function(i){var a,o,t,e,n;e=(e=window.chrome)&&e.app&&e.app.runtime,n="history"in window&&!!window.history.pushState&&!!window.history.replaceState,!e&&n&&(o=function(e,t){var n=Sn(e),r=Sn(t),o=Sn(window.location.href);n.path||(n=o),a=t,o.protocol===r.protocol&&o.host===r.host&&(t=r.relative),o.protocol===n.protocol&&o.host===n.host&&(e=n.relative),i.addBreadcrumb({category:h.NAVIGATION,data:{from:e,to:t},timestamp:(new Date).getTime()})},t=window.onpopstate,window.onpopstate=function(e){if(o(a,window.location.href),t)return t.apply(window,[e])},e=function(r){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=2<e.length?e[2]:void 0;return n&&o(a,n),r.apply(this,e)}},_n(window.history,"pushState",e),_n(window.history,"replaceState",e)),s.info("Breadcrumb integration installed")};var xn=En;function En(){}var Tn=function(e){if(!e||!e.tagName)return"";var t=e.tagName.toLowerCase(),n=e.id?"#"+e.id:"",r="";return r=(r=e.className instanceof SVGAnimatedString?e.className.baseVal:e.className)?"."+r.split(/\s+/).join("."):"","html"===t||"body"===t?t:e.tagName.toLocaleLowerCase()+n+r};function Cn(e){var t,n=[],r=Tn(e);for(n.push(r),t=e.parentNode;t&&(r=Tn(t));)n.push(r),t=t.parentNode;return n.reverse().join(" > ")}Rn.prototype.install=function(i){window.document.addEventListener("click",function(e){var t=(new Date).getTime(),n=e.target;if(on(n)){var r="";try{n.outerHTML&&(r=n.outerHTML.slice(0,200))}catch(e){}var o="";try{o=Cn(n)}catch(e){}(r||o)&&i.addBreadcrumb({category:h.UI_CLICK,timestamp:t,data:{domPath:o,outerHTML:r}})}},!0),s.info("Breadcrumb integration installed")};var On=Rn;function Rn(){}var In=window.navigator.userAgent,kn=(Nn.prototype.install=function(e){s.info("UserAgent installed"),e.addEventProcessor(function(e){if(!e)return null;var t=e.pageInfo||{};return t.url=t.url||window.location.href,t.extraInfo=t.extraInfo||{},t.extraInfo["User-Agent"]=In,t.extraInfo.Referer=document.referrer,f(f({},e),{pageInfo:t})})},Nn);function Nn(){}Dn.prototype.install=function(e){s.info("DeviceDetect installed"),e.addEventProcessor(function(e){if(!e)return null;var t="",n=window.navigator.userAgent||"";if(n.match(/^jdapp/))for(var r=0,o=n.split(";").slice(5);r<o.length;r++){var i=o[r].split("/");"model"===i[0]&&""===t&&(t=i.slice(1).join("/"))}return""!==t&&(e.extraInfo.device=t),e})};var Mn=Dn;function Dn(){}var An=!1,Ln=(Fn.prototype.install=function(p){An||(An=!0,window.addEventListener&&window.addEventListener("error",function(e){var t=!1;if(e){e=e.target||e.srcElement;if(e&&on(e)){var n,r,o=e.tagName.toLowerCase(),i="",a=void 0;if("script"===o?(u=(i=e.src).replace(/\?[^\?]*/,"")).match(/\.js$/)||(d=(n=void 0===(n=Sn(i).queryParams)?{}:n).functionId,r=O(n,["functionId"]),t=!0,a=an(i=u)&&d?(i=u+"?functionId="+d,r):n):"link"===o&&"stylesheet"===e.rel?i=e.href:"img"===o&&(i=e.src),"string"==typeof i&&""!==i){if(p.options.resourceBlacklist&&0<p.options.resourceBlacklist.length)for(var s=0,c=p.options.resourceBlacklist;s<c.length;s++){var l=c[s];if("string"==typeof l&&-1!==i.indexOf(l))return;if("[object RegExp]"===Object.prototype.toString.call(l)&&i.match(l))return}var u="";try{u=e.outerHTML}catch(e){}var d=y({type:m.RESOURCE_ERROR,title:"资源加载失败: "+i,errorDetail:{outerHTML:u,path:Cn(e),resource:i}});t&&(d=y({type:m.JSONP_ERROR,title:"JSONP 请求失败: "+i,errorDetail:{jsonpParams:a}})),p.captureEvent(d)}}}},!0),s.info("UserAgent installed"))},Fn);function Fn(){}jn.prototype.install=function(e){s.info("VisualRegionIntegration installed"),e.addEventProcessor(function(e){if(!e)return null;var t=e.extraInfo,t=void 0===t?{}:t;return window.innerHeight&&window.innerWidth&&(t.visualResolution=window.innerWidth+"x"+window.innerHeight),window.screen&&window.screen.width&&window.screen.height&&(t.screenResolution=window.screen.width+"x"+window.screen.height),void 0!==window.scrollY&&(t.scrollY=""+window.scrollY),f(f({},e),{extraInfo:t})})};var Pn=jn;function jn(){}var Hn=["uranus.jd.com"],Un=(Bn.prototype.install=function(p){s.info("XHRIntegration installed");var e=XMLHttpRequest.prototype;_n(e,"open",function(s){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=(e[0]||"").toUpperCase(),r=e[1]||"";try{var o,i,a=Sn(r);-1!==r.indexOf(p.options.endpoint)||a.host&&-1!==Hn.indexOf(a.host)||"GET"!==n&&"POST"!==n||(o=a.baseUrl||"",i=a.queryParams||{},"GET"===n&&an(r)&&(o=o+"?functionId="+i.functionId,delete i.functionId),this._watchtower_xhr_={method:n,baseUrl:"GET"===n?o:r,params:"GET"===n?i:{}})}catch(e){}return s.apply(this,e)}}),_n(e,"send",function(d){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e[0],a=this;try{if(this._watchtower_xhr_){var r=this._watchtower_xhr_,o=r.method,i=r.baseUrl;if("POST"===o){var s,c,l=!0;try{JSON.parse(n),l=!1}catch(e){l=!0}l?an(i)&&l?(s={},n.split("&").forEach(function(e){s[e.split("=")[0]]=e.split("=")[1]}),this._watchtower_xhr_.baseUrl=i+"?functionId="+s.functionId,s.functionId,c=O(s,["functionId"]),this._watchtower_xhr_.params=c):this._watchtower_xhr_.params=Object.prototype.toString.call(n):this._watchtower_xhr_.params=n}this._watchtower_xhr_.requestBeginTime=(new Date).getTime();var u=a.onreadystatechange;a.onreadystatechange=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(4===a.readyState){var n=(new Date).getTime(),r=(a._watchtower_xhr_.duration=n-a._watchtower_xhr_.requestBeginTime,"unknown"),o=a.responseType&&"text"!==a.responseType?a.response:a.responseText;a._watchtower_xhr_.responseText=o;try{r=a.status,i=a.getAllResponseHeaders()||"",a._watchtower_xhr_.responseHeader=i}catch(e){}"unknown"!==(a._watchtower_xhr_.code=r)&&(300<=r&&r<400&&((o=a.getResponseHeader("Location"))&&(a._watchtower_xhr_.location=o),p.captureEvent(y({type:m.XHR_ERROR,title:"XHR 重定向: "+a._watchtower_xhr_.baseUrl,errorDetail:{method:a._watchtower_xhr_.method,baseUrl:a._watchtower_xhr_.baseUrl,params:a._watchtower_xhr_.params,duration:a._watchtower_xhr_.duration,location:a._watchtower_xhr_.location,code:a._watchtower_xhr_.code,responseHeader:a._watchtower_xhr_.responseHeader}}))),400<=r&&p.captureEvent(y({type:m.XHR_ERROR,title:"XHR 请求失败(Code: "+a._watchtower_xhr_.code+"): "+a._watchtower_xhr_.baseUrl,errorDetail:{method:a._watchtower_xhr_.method,baseUrl:a._watchtower_xhr_.baseUrl,params:a._watchtower_xhr_.params,duration:a._watchtower_xhr_.duration,responseText:null,code:a._watchtower_xhr_.code,responseHeader:a._watchtower_xhr_.responseHeader}}))),p.addBreadcrumb({category:h.XHR,timestamp:n,data:f({},a._watchtower_xhr_)})}if("function"==typeof u)try{u.apply(a,e)}catch(e){var i=hn(e);i&&p.captureEvent(i)}}}}catch(e){console.log("发送异常，"+e)}return d.apply(this,e)}})},Bn);function Bn(){}var zn=r(Object.keys,Object),Wn=Object.prototype.hasOwnProperty;var Vn=function(e){if(!ht(e))return zn(e);var t,n=[];for(t in Object(e))Wn.call(e,t)&&"constructor"!=t&&n.push(t);return n};var Xn=function(e){return(_t(e)?Ut:Vn)(e)},qn=Object.prototype.hasOwnProperty,Gn=o(function(e,t){if(ht(t)||_t(t))Lt(t,Xn(t),e);else for(var n in t)qn.call(t,n)&&At(e,n,t[n])}),n="undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{},Jn=n,Yn=($n.prototype.install=function(f){G()?(s.info("FetchIntegration installed"),_n(window,"fetch",function(p){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n,r=e[0],s=!1,c="GET",l="",u={},o="",i="",r=("string"==typeof r?o=r:"Request"in Jn&&r instanceof Request?(o=r.url,r.method&&(c=r.method)):o=String(r),c=(c=e[1]&&e[1].method?e[1].method:c).toUpperCase(),i=(i=e[1]&&e[1].headers&&e[1].headers["Content-Type"]?e[1].headers["Content-Type"]:i).toLowerCase(),Sn(o));if(o&&-1===o.indexOf(f.options.endpoint)&&r.host&&-1===Hn.indexOf(r.host)){if(s=!0,l=r.baseUrl||"",Gn(u,r.queryParams),"POST"===c&&e[1]&&e[1].body){r=e[1].body;if(n=r,"[object Object]"===Object.prototype.toString.call(n))Gn(u,r);else if("application/json"===i)try{var a=JSON.parse(r);Gn(u,a)}catch(e){}else if("application/x-www-form-urlencoded"===i)try{Gn(u,{param:r})}catch(e){}else if("string"==typeof r)try{a=JSON.parse(r);Gn(u,a)}catch(e){}}an(o)&&u.functionId&&(l=l+"?functionId="+u.functionId,delete u.functionId)}var d=(new Date).getTime();return p.apply(window,e).then(function(n){var r,o,i,a;return s&&(r=[],n.headers.forEach(function(e,t){r.push({key:t,value:e})}),o=(new Date).getTime(),i=o-d,a=n.status,n.clone().text().then(function(e){var t;300<=a&&a<400?(t=n.headers.get("Location"),f.captureEvent(y({type:m.FETCH_ERROR,title:"Fetch 重定向: "+l,errorDetail:{method:c,baseUrl:l,params:u,duration:i,location:t,code:a,responseHeader:r}}))):400<=a&&f.captureEvent(y({type:m.FETCH_ERROR,title:"Fetch 请求失败(Code: "+a+"): "+l,errorDetail:{method:c,baseUrl:l,params:u,duration:i,code:a,responseText:e,responseHeader:r}})),f.addBreadcrumb({category:h.FETCH,timestamp:o,data:{method:c,baseUrl:l,params:u,duration:i,code:a,responseText:e,responseHeader:r}})}).catch(function(e){})),n}).catch(function(e){var t,n;throw s&&(t=(new Date).getTime(),f.captureEvent(y({type:m.FETCH_ERROR,title:"Fetch 请求失败(网络异常): "+l,errorDetail:{method:c,baseUrl:l,params:u,duration:n=t-d}})),f.addBreadcrumb({category:h.FETCH,timestamp:t,data:{method:c,baseUrl:l,params:u,duration:n,code:"网络异常"}})),e})}})):s.info("当前环境无原生 Fetch 支持，跳过 FetchIntegration")},$n);function $n(){}var Qn=!1,Kn=(Zn.prototype.install=function(n){Qn||(Qn=!0,window.addEventListener&&window.addEventListener("unhandledrejection",function(e){var t;return e.preventDefault(),e&&(t=y({type:m.UNHANDLEDREJECTION,title:"Promise 请求拒绝: "+(null!=(t=null==e?void 0:e.reason)&&t.message?null==(t=null==e?void 0:e.reason)?void 0:t.message:null==e?void 0:e.reason),errorDetail:{stack:(null==(t=null==e?void 0:e.reason)?void 0:t.stack)||""+(null==e?void 0:e.reason)}}),n.captureEvent(t)),!0},!0),s.info("Unhandledrejection installed"))},Zn);function Zn(){}var er=!1,tr=(nr.prototype.install=function(e){var t=this;er||(this.sensor=e,this.loop(),setInterval(function(){t.isLowFPS()&&t.catchLowFPS()},1e3),er=!0)},nr.prototype.loop=function(){var n=this,r=performance.now(),o=0,i=performance.now(),a=function(){var e=performance.now(),t=e-i,t=(i=e,Math.round(1e3/t));o++,1e3+r<e&&(t=Math.round(1e3*o/(e-r)),o=0,r=e),n.fpsList.push(t),window.requestAnimationFrame(a)};window.requestAnimationFrame(a)},nr.prototype.catchLowFPS=function(){var t=this;this.wait||(this.wait=!0,setTimeout(function(){var e=y({type:m.LOW_FPS,title:"LowFPS: 页面卡顿告警",errorDetail:{fpsLowerList:t.fpsLowerList.shift()}});t.sensor.captureEvent(e),t.wait=!1},6e4))},nr.prototype.isLowFPS=function(){var e=0,t=[],n=this.fpsList;this.fpsList=[];for(var r=0;r<n.length;r++)if(n[r]<20?(t.push(n[r]),e++):(t=[],e=0),5<=e)return this.fpsLowerList.length<20&&this.fpsLowerList.push(t),!0;return!1},nr);function nr(){this.wait=!1,this.sensor=null,this.fpsLowerList=[],this.fpsList=[]}var rr,or=!1,ir="watchtower",a="t_crash",ar="watchtower_worker",sr=(c.prototype.install=function(i){if(!or){try{var e=window.indexedDB.open(ir,1);e.onsuccess=function(){try{rr=e.result,setTimeout(function(){var o;rr.objectStoreNames.contains(a)&&((o=rr.transaction([a]).objectStore(a).get(1)).onsuccess=function(e){var t,n,r;o.result&&(c.remove(),t=(r=o.result).title,n=r.time,r=r.memory,i.captureEvent(y({type:m.PAGE_CRASH,title:"页面崩溃: "+t,errorDetail:{time:n,jsHeapSizeLimit:r&&r.jsHeapSizeLimit,usedJSHeapSize:r&&r.usedJSHeapSize,totalJSHeapSize:r&&r.totalJSHeapSize}})))})},0)}catch(e){console.log(e)}},e.onupgradeneeded=function(e){(rr=e&&e.target&&e.target.result).objectStoreNames.contains(a)||rr.createObjectStore(a,{keyPath:"id"}).createIndex("title","title",{unique:!1})}}catch(e){}c.createWorker(),or=!0}},c.remove=function(){rr.transaction([a],"readwrite").objectStore(a).delete(1).onsuccess=function(){}},c.createWorker=function(){window.onload=function(){c.addWorkerScript(),setTimeout(function(){c.addMainScript()},1e3)}},c.addWorkerScript=function(){var e=document.body,t=document.createElement("script");t.type="watchtower/worker",t.id=ar,t.innerHTML='\n        let db,\n        pageInfo = {};\n      onmessage = function(e) {\n        pageInfo = e.data;\n      };\n      let worker_timer = setInterval(() => {\n        if (pageInfo.time && new Date().getTime() - pageInfo.time > 6000) {\n          openDB();\n          clearInterval(worker_timer);\n        }\n      }, 2000);\n      function openDB() {\n        var request = self.indexedDB.open("'+ir+'", 1);\n        request.onsuccess = function(event) {\n          db = request.result;\n          addData();\n        };\n      }\n      function addData() {\n        const { time, title, memory } = pageInfo;\n        var request = db\n          .transaction(["'+a+'"], "readwrite")\n          .objectStore("'+a+'")\n          .add({\n            id: 1,\n            time,\n            title,\n            memory,\n          });\n      }\n    ',e.appendChild(t)},c.addMainScript=function(){var e=document.body,t=document.createElement("script");t.type="text/javascript",t.innerHTML='\n      var blob = new Blob([\n        document.querySelector("#'+ar+'").textContent,\n      ]);\n      var url = window.URL.createObjectURL(blob);\n      var worker = new Worker(url);\n      let timer = setInterval(() => {\n        const {\n          jsHeapSizeLimit,\n          usedJSHeapSize,\n          totalJSHeapSize,\n        } = window.performance.memory;\n        worker.postMessage({\n          time: new Date().getTime(),\n          title: window.location.href,\n          memory: {\n            jsHeapSizeLimit,\n            usedJSHeapSize,\n            totalJSHeapSize,\n          },\n        });\n      }, 2000);\n    ',e.appendChild(t)},c);function c(){}var I,ie=function(){return(ie=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function ae(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&r>=e.length?void 0:e)&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function cr(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}function se(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(cr(arguments[t]));return e}function lr(e){return e.nodeType===e.ELEMENT_NODE}function ur(e){var t=null==(t=e)?void 0:t.host;return Boolean(t&&t.shadowRoot&&t.shadowRoot===e)}function dr(e){var t=e.maskInputOptions,n=e.tagName,r=e.type,o=e.value,e=e.maskInputFn,o=o||"";return o=t[n.toLowerCase()]||t[r]?e?e(o):"*".repeat(o.length):o}(r=I=I||{})[r.Document=0]="Document",r[r.DocumentType=1]="DocumentType",r[r.Element=2]="Element",r[r.Text=3]="Text",r[r.CDATA=4]="CDATA",r[r.Comment=5]="Comment";var pr=1,fr=new RegExp("[^a-z0-9-_:]"),hr=-2;function mr(e){try{var t=e.rules||e.cssRules;return t?Array.from(t).map(vr).join(""):null}catch(e){return null}}function vr(e){var t=e.cssText;if("styleSheet"in e)try{t=mr(e.styleSheet)||t}catch(e){}return t}var yr=/url\((?:(')([^']*)'|(")(.*?)"|([^)]*))\)/gm,gr=/^(?!www\.|(?:http|ftp)s?:\/\/|[A-Za-z]:\\|\/\/|#).*/,wr=/^(data:)([^,]*),(.*)/i;function br(e,u){return(e||"").replace(yr,function(e,t,n,r,o,i){n=n||o||i,o=t||r||"";if(!n)return e;if(!gr.test(n))return"url("+o+n+o+")";if(wr.test(n))return"url("+o+n+o+")";if("/"===n[0])return"url("+o+((i=(i=-1<(i=u).indexOf("//")?i.split("/").slice(0,3).join("/"):i.split("/")[0]).split("?")[0])+n)+o+")";var a=u.split("/"),t=n.split("/");a.pop();for(var s=0,c=t;s<c.length;s++){var l=c[s];"."!==l&&(".."===l?a.pop():a.push(l))}return"url("+o+a.join("/")+o+")"})}var Sr=/^[^ \t\n\r\u000c]+/,_r=/^[, \t\n\r\u000c]+/;function xr(e,t){if(!t||""===t.trim())return t;e=e.createElement("a");return e.href=t,e.href}function Er(){var e=document.createElement("a");return e.href="",e.href}function Tr(e,t,n,r){if("src"===n||"href"===n&&r)return xr(e,r);if("xlink:href"===n&&r&&"#"!==r[0])return xr(e,r);if("background"!==n||!r||"table"!==t&&"td"!==t&&"th"!==t){if("srcset"===n&&r){var o=e,i=r;if(""===i.trim())return i;var a=0;function s(e){var e=e.exec(i.substring(a));return e?(e=e[0],a+=e.length,e):""}for(var c=[];s(_r),!(a>=i.length);)if(","===(u=s(Sr)).slice(-1))u=xr(o,u.substring(0,u.length-1)),c.push(u);else for(var l="",u=xr(o,u),d=!1;;){var p=i.charAt(a);if(""===p){c.push((u+l).trim());break}if(d)")"===p&&(d=!1);else{if(","===p){a+=1,c.push((u+l).trim());break}"("===p&&(d=!0)}l+=p,a+=1}return c.join(", ")}return"style"===n&&r?br(r,Er()):"object"===t&&"data"===n&&r?xr(e,r):r}return xr(e,r)}function Cr(e,t,n){if(!e)return!1;if(e.nodeType!==e.ELEMENT_NODE)return e.nodeType,e.TEXT_NODE,Cr(e.parentNode,t,n);if("string"==typeof t){if(e.classList.contains(t))return!0}else e.classList.forEach(function(e){if(t.test(e))return!0});return!(!n||!e.matches(n))||Cr(e.parentNode,t,n)}function Or(t,e){var n,r,o,i=e.doc,a=e.blockClass,s=e.blockSelector,c=e.maskTextClass,l=e.maskTextSelector,u=e.inlineStylesheet,d=e.maskInputOptions,p=void 0===d?{}:d,f=e.maskTextFn,h=e.maskInputFn,m=e.recordCanvas,v=e.keepIframeSrcFn;switch(i.__sn&&(r=1===(d=i.__sn.id)?void 0:d),t.nodeType){case t.DOCUMENT_NODE:return"CSS1Compat"!==t.compatMode?{type:I.Document,childNodes:[],compatMode:t.compatMode,rootId:r}:{type:I.Document,childNodes:[],rootId:r};case t.DOCUMENT_TYPE_NODE:return{type:I.DocumentType,name:t.name,publicId:t.publicId,systemId:t.systemId,rootId:r};case t.ELEMENT_NODE:for(var y,g=function(e,t,n){if("string"==typeof t){if(e.classList.contains(t))return!0}else for(var r=0;r<e.classList.length;r++){var o=e.classList[r];if(t.test(o))return!0}return!!n&&e.matches(n)}(t,a,s),w=(C=t)instanceof HTMLFormElement?"form":(C=C.tagName.toLowerCase().trim(),fr.test(C)?"div":C),b={},S=0,_=Array.from(t.attributes);S<_.length;S++){var x=_[S],E=x.name,T=x.value;b[E]=Tr(i,w,E,T)}return"link"===w&&u&&(y=mr(C=Array.from(i.styleSheets).find(function(e){return e.href===t.href})))&&(delete b.rel,delete b.href,b._cssText=br(y,C.href)),"style"===w&&t.sheet&&!(t.innerText||t.textContent||"").trim().length&&(y=mr(t.sheet))&&(b._cssText=br(y,Er())),"input"!==w&&"textarea"!==w&&"select"!==w||(T=t.value,"radio"!==b.type&&"checkbox"!==b.type&&"submit"!==b.type&&"button"!==b.type&&T?b.value=dr({type:b.type,tagName:w,value:T,maskInputOptions:p,maskInputFn:h}):t.checked&&(b.checked=t.checked)),"option"===w&&(t.selected?b.selected=!0:delete b.selected),"canvas"===w&&m&&(b.rr_dataURL=t.toDataURL()),"audio"!==w&&"video"!==w||(b.rr_mediaState=t.paused?"paused":"played",b.rr_mediaCurrentTime=t.currentTime),t.scrollLeft&&(b.rr_scrollLeft=t.scrollLeft),t.scrollTop&&(b.rr_scrollTop=t.scrollTop),g&&(y=(C=t.getBoundingClientRect()).width,C=C.height,b={class:b.class,rr_width:y+"px",rr_height:C+"px"}),"iframe"!==w||v(b.src)||(t.contentDocument||(b.rr_src=b.src),delete b.src),{type:I.Element,tagName:w,attributes:b,childNodes:[],isSVG:"svg"===(y=t).tagName||y instanceof SVGElement||void 0,needBlock:g,rootId:r};case t.TEXT_NODE:var C=t.parentNode&&t.parentNode.tagName,g=t.textContent,O="STYLE"===C||void 0,R="SCRIPT"===C||void 0;if(O&&g){try{null!=(n=t.parentNode.sheet)&&n.cssRules&&(g=(o=t.parentNode.sheet).cssRules?Array.from(o.cssRules).map(function(e){return e.cssText||""}).join(""):"")}catch(e){}g=br(g,Er())}return R&&(g="SCRIPT_PLACEHOLDER"),!O&&!R&&Cr(t,c,l)&&g&&(g=f?f(g):g.replace(/[\S]/g,"*")),{type:I.Text,textContent:g||"",isStyle:O,rootId:r};case t.CDATA_SECTION_NODE:return{type:I.CDATA,textContent:"",rootId:r};case t.COMMENT_NODE:return{type:I.Comment,textContent:t.textContent||"",rootId:r};default:return!1}}function R(e){return void 0===e?"":e.toLowerCase()}function Rr(t,e){var n=e.doc,r=e.map,o=e.blockClass,i=e.blockSelector,a=e.maskTextClass,s=e.maskTextSelector,c=e.skipChild,c=void 0!==c&&c,l=e.inlineStylesheet,u=void 0===l||l,l=e.maskInputOptions,d=void 0===l?{}:l,p=e.maskTextFn,f=e.maskInputFn,h=e.slimDOMOptions,l=e.recordCanvas,m=void 0!==l&&l,v=e.onSerialize,y=e.onIframeLoad,l=e.iframeLoadTimeout,g=void 0===l?5e3:l,l=e.keepIframeSrcFn,w=void 0===l?function(){return!1}:l,l=e.preserveWhiteSpace,b=void 0===l||l,e=Or(t,{doc:n,blockClass:o,blockSelector:i,maskTextClass:a,maskTextSelector:s,inlineStylesheet:u,maskInputOptions:d,maskTextFn:p,maskInputFn:f,recordCanvas:m,keepIframeSrcFn:w});if(!e)return console.warn(t,"not serialized"),null;var l="__sn"in t?t.__sn.id:!function(e,t){if(t.comment&&e.type===I.Comment)return 1;if(e.type===I.Element){if(t.script&&("script"===e.tagName||"link"===e.tagName&&"preload"===e.attributes.rel&&"script"===e.attributes.as||"link"===e.tagName&&"prefetch"===e.attributes.rel&&"string"==typeof e.attributes.href&&e.attributes.href.endsWith(".js")))return 1;if(t.headFavicon&&("link"===e.tagName&&"shortcut icon"===e.attributes.rel||"meta"===e.tagName&&(R(e.attributes.name).match(/^msapplication-tile(image|color)$/)||"application-name"===R(e.attributes.name)||"icon"===R(e.attributes.rel)||"apple-touch-icon"===R(e.attributes.rel)||"shortcut icon"===R(e.attributes.rel))))return 1;if("meta"===e.tagName){if(t.headMetaDescKeywords&&R(e.attributes.name).match(/^description|keywords$/))return 1;if(t.headMetaSocial&&(R(e.attributes.property).match(/^(og|twitter|fb):/)||R(e.attributes.name).match(/^(og|twitter):/)||"pinterest"===R(e.attributes.name)))return 1;if(t.headMetaRobots&&("robots"===R(e.attributes.name)||"googlebot"===R(e.attributes.name)||"bingbot"===R(e.attributes.name)))return 1;if(t.headMetaHttpEquiv&&void 0!==e.attributes["http-equiv"])return 1;if(t.headMetaAuthorship&&("author"===R(e.attributes.name)||"generator"===R(e.attributes.name)||"framework"===R(e.attributes.name)||"publisher"===R(e.attributes.name)||"progid"===R(e.attributes.name)||R(e.attributes.property).match(/^article:/)||R(e.attributes.property).match(/^product:/)))return 1;if(t.headMetaVerification&&("google-site-verification"===R(e.attributes.name)||"yandex-verification"===R(e.attributes.name)||"csrf-token"===R(e.attributes.name)||"p:domain_verify"===R(e.attributes.name)||"verify-v1"===R(e.attributes.name)||"verification"===R(e.attributes.name)||"shopify-checkout-api-token"===R(e.attributes.name)))return 1}}}(e,h)&&(b||e.type!==I.Text||e.isStyle||e.textContent.replace(/^\s+|\s+$/gm,"").length)?pr++:hr,S=Object.assign(e,{id:l});if(t.__sn=S,l===hr)return null;r[l]=t,v&&v(t);l=!c;if(S.type===I.Element&&(l=l&&!S.needBlock,delete S.needBlock),(S.type===I.Document||S.type===I.Element)&&l){h.headWhitespace&&e.type===I.Element&&"head"===e.tagName&&(b=!1);for(var _={doc:n,map:r,blockClass:o,blockSelector:i,maskTextClass:a,maskTextSelector:s,skipChild:c,inlineStylesheet:u,maskInputOptions:d,maskTextFn:p,maskInputFn:f,slimDOMOptions:h,recordCanvas:m,preserveWhiteSpace:b,onSerialize:v,onIframeLoad:y,iframeLoadTimeout:g,keepIframeSrcFn:w},x=0,E=Array.from(t.childNodes);x<E.length;x++)(T=Rr(E[x],_))&&S.childNodes.push(T);if(lr(t)&&t.shadowRoot){S.isShadowHost=!0;for(var T,C=0,O=Array.from(t.shadowRoot.childNodes);C<O.length;C++)(T=Rr(O[C],_))&&(T.isShadow=!0,S.childNodes.push(T))}}return t.parentNode&&ur(t.parentNode)&&(S.isShadow=!0),S.type===I.Element&&"iframe"===S.tagName&&function(e,t,n){var r=e.contentWindow;if(r){var o,i=!1;try{a=r.document.readyState}catch(e){return}if("complete"!==a)return o=setTimeout(function(){i||(t(),i=!0)},n),e.addEventListener("load",function(){clearTimeout(o),i=!0,t()});var a="about:blank";r.location.href!==a||e.src===a||""===e.src?setTimeout(t,0):e.addEventListener("load",t)}}(t,function(){var e=t.contentDocument;e&&y&&((e=Rr(e,{doc:e,map:r,blockClass:o,blockSelector:i,maskTextClass:a,maskTextSelector:s,skipChild:!1,inlineStylesheet:u,maskInputOptions:d,maskTextFn:p,maskInputFn:f,slimDOMOptions:h,recordCanvas:m,preserveWhiteSpace:b,onSerialize:v,onIframeLoad:y,iframeLoadTimeout:g,keepIframeSrcFn:w}))&&y(t,e))},g),S}var Ir=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g;function kr(r,n){void 0===n&&(n={});var o=1,i=1;function a(e){var t=e.match(/\n/g),t=(t&&(o+=t.length),e.lastIndexOf("\n"));i=-1===t?i+e.length:e.length-t}function s(){var t={line:o,column:i};return function(e){return e.position=new c(t),m(),e}}var c=function(e){this.start=e,this.end={line:o,column:i},this.source=n.source},l=(c.prototype.content=r,[]);function u(e){var t=new Error(n.source+":"+o+":"+i+": "+e);if(t.reason=e,t.filename=n.source,t.line=o,t.column=i,t.source=r,!n.silent)throw t;l.push(t)}function d(){return h(/^{\s*/)}function p(){return h(/^}/)}function f(){var e,t,n=[];for(m(),v(n);r.length&&"}"!==r.charAt(0)&&(e=function(){if("@"===r[0])return function(){var e=s(),t=h(/^@([-\w]+)?keyframes\s*/);if(t){var n=t[1];if(!(t=h(/^([-\w]+)\s*/)))return u("@keyframes missing name");var r,t=t[1];if(!d())return u("@keyframes missing '{'");for(var o=v();r=function(){var e,t=[],n=s();for(;e=h(/^((\d+\.\d+|\.\d+|\d+)%?|[a-z]+)\s*/);)t.push(e[1]),h(/^,\s*/);if(t.length)return n({type:"keyframe",values:t,declarations:b()})}();)o.push(r),o=o.concat(v());return p()?e({type:"keyframes",name:t,vendor:n,keyframes:o}):u("@keyframes missing '}'")}}()||function(){var e=s(),t=h(/^@media *([^{]+)/);if(t){t=E(t[1]);if(!d())return u("@media missing '{'");var n=v().concat(f());return p()?e({type:"media",media:t,rules:n}):u("@media missing '}'")}}()||function(){var e=s(),t=h(/^@custom-media\s+(--[^\s]+)\s*([^{;]+);/);if(t)return e({type:"custom-media",name:E(t[1]),media:E(t[2])})}()||function(){var e=s(),t=h(/^@supports *([^{]+)/);if(t){t=E(t[1]);if(!d())return u("@supports missing '{'");var n=v().concat(f());return p()?e({type:"supports",supports:t,rules:n}):u("@supports missing '}'")}}()||S()||_()||x()||function(){var e=s(),t=h(/^@([-\w]+)?document *([^{]+)/);if(t){var n=E(t[1]),t=E(t[2]);if(!d())return u("@document missing '{'");var r=v().concat(f());return p()?e({type:"document",document:t,vendor:n,rules:r}):u("@document missing '}'")}}()||function(){var e=s();if(h(/^@page */)){var t=g()||[];if(!d())return u("@page missing '{'");for(var n,r=v();n=w();)r.push(n),r=r.concat(v());return p()?e({type:"page",selectors:t,declarations:r}):u("@page missing '}'")}}()||function(){var e=s();if(h(/^@host\s*/)){if(!d())return u("@host missing '{'");var t=v().concat(f());return p()?e({type:"host",rules:t}):u("@host missing '}'")}}()||function(){var e=s();if(h(/^@font-face\s*/)){if(!d())return u("@font-face missing '{'");for(var t,n=v();t=w();)n.push(t),n=n.concat(v());return p()?e({type:"font-face",declarations:n}):u("@font-face missing '}'")}}()}()||(t=e=void 0,e=s(),(t=g())?(v(),e({type:"rule",selectors:t,declarations:b()})):u("selector missing")));)!1!==e&&(n.push(e),v(n));return n}function h(e){var t,e=e.exec(r);if(e)return t=e[0],a(t),r=r.slice(t.length),e}function m(){h(/^\s*/)}function v(e){var t;for(void 0===e&&(e=[]);t=y();)!1!==t&&e.push(t),t=y();return e}function y(){var e=s();if("/"===r.charAt(0)&&"*"===r.charAt(1)){for(var t=2;""!==r.charAt(t)&&("*"!==r.charAt(t)||"/"!==r.charAt(t+1));)++t;if(""===r.charAt((t+=2)-1))return u("End of comment missing");var n=r.slice(2,t-2);return i+=2,a(n),r=r.slice(t),i+=2,e({type:"comment",comment:n})}}function g(){var e=h(/^([^{]+)/);if(e)return E(e[0]).replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*\/+/g,"").replace(/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'/g,function(e){return e.replace(/,/g,"‌")}).split(/\s*(?![^(]*\)),\s*/).map(function(e){return e.replace(/\u200C/g,",")})}function w(){var e=s(),t=h(/^(\*?[-#\/\*\\\w]+(\[[0-9a-z_-]+\])?)\s*/);if(t){t=E(t[0]);if(!h(/^:\s*/))return u("property missing ':'");var n=h(/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^\)]*?\)|[^};])+)/),e=e({type:"declaration",property:t.replace(Ir,""),value:n?E(n[0]).replace(Ir,""):""});return h(/^[;\s]*/),e}}function b(){var e,t=[];if(!d())return u("missing '{'");for(v(t);e=w();)!1!==e&&(t.push(e),v(t)),e=w();return p()?t:u("missing '}'")}var e,S=t("import"),_=t("charset"),x=t("namespace");function t(r){var o=new RegExp("^@"+r+"\\s*([^;]+);");return function(){var e,t=s(),n=h(o);if(n)return e={type:r},e[r]=n[1].trim(),t(e)}}return function t(e,n){var r=e&&"string"==typeof e.type;var o=r?e:n;for(var i=0,a=Object.keys(e);i<a.length;i++){var s=a[i],s=e[s];Array.isArray(s)?s.forEach(function(e){t(e,o)}):s&&"object"==typeof s&&t(s,o)}r&&Object.defineProperty(e,"parent",{configurable:!0,writable:!0,enumerable:!1,value:n||null});return e}((e=f(),{type:"stylesheet",stylesheet:{source:n.source,rules:e,parsingErrors:l}}))}function E(e){return e?e.replace(/^\s+|\s+$/g,""):""}var Nr={script:"noscript",altglyph:"altGlyph",altglyphdef:"altGlyphDef",altglyphitem:"altGlyphItem",animatecolor:"animateColor",animatemotion:"animateMotion",animatetransform:"animateTransform",clippath:"clipPath",feblend:"feBlend",fecolormatrix:"feColorMatrix",fecomponenttransfer:"feComponentTransfer",fecomposite:"feComposite",feconvolvematrix:"feConvolveMatrix",fediffuselighting:"feDiffuseLighting",fedisplacementmap:"feDisplacementMap",fedistantlight:"feDistantLight",fedropshadow:"feDropShadow",feflood:"feFlood",fefunca:"feFuncA",fefuncb:"feFuncB",fefuncg:"feFuncG",fefuncr:"feFuncR",fegaussianblur:"feGaussianBlur",feimage:"feImage",femerge:"feMerge",femergenode:"feMergeNode",femorphology:"feMorphology",feoffset:"feOffset",fepointlight:"fePointLight",fespecularlighting:"feSpecularLighting",fespotlight:"feSpotLight",fetile:"feTile",feturbulence:"feTurbulence",foreignobject:"foreignObject",glyphref:"glyphRef",lineargradient:"linearGradient",radialgradient:"radialGradient"};var F,ce,g,w,Mr=/([^\\]):hover/,Dr=new RegExp(Mr.source,"g");function Ar(e,t){var n=null==t?void 0:t.stylesWithHoverClass.get(e);if(n)return n;n=kr(e,{silent:!0});if(!n.stylesheet)return e;var r=[];if(n.stylesheet.rules.forEach(function(e){"selectors"in e&&(e.selectors||[]).forEach(function(e){Mr.test(e)&&r.push(e)})}),0===r.length)return e;n=new RegExp(r.filter(function(e,t){return r.indexOf(e)===t}).sort(function(e,t){return t.length-e.length}).map(function(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}).join("|"),"g"),n=e.replace(n,function(e){var t=e.replace(Dr,"$1.\\:hover");return e+", "+t});return null!=t&&t.stylesWithHoverClass.set(e,n),n}function Lr(){return{stylesWithHoverClass:new Map}}function Fr(c,e){var t,n,l=e.doc,u=e.hackCss,d=e.cache;switch(c.type){case I.Document:return l.implementation.createDocument(null,"",null);case I.DocumentType:return l.implementation.createDocumentType(c.name||"html",c.publicId,c.systemId);case I.Element:var r,p=n="link"===(n=Nr[(t=c).tagName]||t.tagName)&&t.attributes._cssText?"style":n,f=c.isSVG?l.createElementNS("http://www.w3.org/2000/svg",p):l.createElement(p);for(r in c.attributes)!function(e){if(!c.attributes.hasOwnProperty(e))return;var t,n=c.attributes[e];if("option"===p&&"selected"===e&&!1===n)return;if(n="boolean"==typeof n||"number"==typeof n?"":n,e.startsWith("rr_")){if("canvas"===p&&"rr_dataURL"===e&&((t=document.createElement("img")).src=n,t.onload=function(){var e=f.getContext("2d");e&&e.drawImage(t,0,0,t.width,t.height)}),"rr_width"===e&&(f.style.width=n),"rr_height"===e&&(f.style.height=n),"rr_mediaCurrentTime"===e&&(f.currentTime=c.attributes.rr_mediaCurrentTime),"rr_mediaState"===e)switch(n){case"played":f.play().catch(function(e){return console.warn("media playback error",e)});break;case"paused":f.pause()}}else{var r="textarea"===p&&"value"===e,o="style"===p&&"_cssText"===e;if(o&&u&&(n=Ar(n,d)),r||o){for(var r=l.createTextNode(n),i=0,a=Array.from(f.childNodes);i<a.length;i++){var s=a[i];s.nodeType===f.TEXT_NODE&&f.removeChild(s)}return f.appendChild(r)}try{if(c.isSVG&&"xlink:href"===e)f.setAttributeNS("http://www.w3.org/1999/xlink",e,n);else if("onload"===e||"onclick"===e||"onmouse"===e.substring(0,7))f.setAttribute("_"+e,n);else{if("meta"===p&&"Content-Security-Policy"===c.attributes["http-equiv"]&&"content"===e)return f.setAttribute("csp-content",n);"link"===p&&"preload"===c.attributes.rel&&"script"===c.attributes.as||"link"===p&&"prefetch"===c.attributes.rel&&"string"==typeof c.attributes.href&&c.attributes.href.endsWith(".js")||f.setAttribute(e,n)}}catch(e){}}}(r);if(c.isShadowHost)if(f.shadowRoot)for(;f.shadowRoot.firstChild;)f.shadowRoot.removeChild(f.shadowRoot.firstChild);else f.attachShadow({mode:"open"});return f;case I.Text:return l.createTextNode(c.isStyle&&u?Ar(c.textContent,d):c.textContent);case I.CDATA:return l.createCDATASection(c.textContent);case I.Comment:return l.createComment(c.textContent);default:return null}}function Pr(e,t){var n=t.doc,r=t.map,o=t.skipChild,o=void 0!==o&&o,i=t.hackCss,a=void 0===i||i,s=t.afterAppend,c=t.cache,l=Fr(e,{doc:n,hackCss:a,cache:c});if(!l)return null;if(e.rootId&&console.assert(r[e.rootId]===n,"Target document should has the same root id."),e.type===I.Document&&(n.close(),n.open(),"BackCompat"===e.compatMode&&e.childNodes&&e.childNodes[0].type!==I.DocumentType&&(e.childNodes[0].type===I.Element&&"xmlns"in e.childNodes[0].attributes&&"http://www.w3.org/1999/xhtml"===e.childNodes[0].attributes.xmlns?n.write('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "">'):n.write('<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "">')),l=n),r[(l.__sn=e).id]=l,(e.type===I.Document||e.type===I.Element)&&!o)for(var u=0,d=e.childNodes;u<d.length;u++){var p=d[u],f=Pr(p,{doc:n,map:r,skipChild:!1,hackCss:a,afterAppend:s,cache:c});f?((p.isShadow&&lr(l)&&l.shadowRoot?l.shadowRoot:l).appendChild(f),s&&s(f)):console.warn("Failed to rebuild",p)}return l}function jr(e,t){for(var n in e)e[n]&&(n=e[n],t(n))}function Hr(e,t){var n=t.doc,i=t.onVisit,r=t.hackCss,o={},e=Pr(e,{doc:n,map:o,skipChild:!1,hackCss:void 0===r||r,afterAppend:t.afterAppend,cache:t.cache});return jr(o,function(e){i&&i(e);var t=e.__sn;if(t.type===I.Element){var n,r,o=e;for(n in t.attributes)t.attributes.hasOwnProperty(n)&&n.startsWith("rr_")&&(r=t.attributes[n],"rr_scrollLeft"===n&&(o.scrollLeft=r),"rr_scrollTop"===n&&(o.scrollTop=r))}}),[e,o]}function le(e,t,n){void 0===n&&(n=document);var r={capture:!0,passive:!0};return n.addEventListener(e,t,r),function(){return n.removeEventListener(e,t,r)}}function Ur(){return{map:{},getId:function(e){return e&&e.__sn?e.__sn.id:-1},getNode:function(e){return this.map[e]||null},removeNodeFromMap:function(e){var t=this,n=e.__sn&&e.__sn.id;delete this.map[n],e.childNodes&&e.childNodes.forEach(function(e){return t.removeNodeFromMap(e)})},has:function(e){return this.map.hasOwnProperty(e)},reset:function(){this.map={}}}}(o=F=F||{})[o.DomContentLoaded=0]="DomContentLoaded",o[o.Load=1]="Load",o[o.FullSnapshot=2]="FullSnapshot",o[o.IncrementalSnapshot=3]="IncrementalSnapshot",o[o.Meta=4]="Meta",o[o.Custom=5]="Custom",o[o.Plugin=6]="Plugin",(e=ce=ce||{})[e.Mutation=0]="Mutation",e[e.MouseMove=1]="MouseMove",e[e.MouseInteraction=2]="MouseInteraction",e[e.Scroll=3]="Scroll",e[e.ViewportResize=4]="ViewportResize",e[e.Input=5]="Input",e[e.TouchMove=6]="TouchMove",e[e.MediaInteraction=7]="MediaInteraction",e[e.StyleSheetRule=8]="StyleSheetRule",e[e.CanvasMutation=9]="CanvasMutation",e[e.Font=10]="Font",e[e.Log=11]="Log",e[e.Drag=12]="Drag",e[e.StyleDeclaration=13]="StyleDeclaration",(n=g=g||{})[n.MouseUp=0]="MouseUp",n[n.MouseDown=1]="MouseDown",n[n.Click=2]="Click",n[n.ContextMenu=3]="ContextMenu",n[n.DblClick=4]="DblClick",n[n.Focus=5]="Focus",n[n.Blur=6]="Blur",n[n.TouchStart=7]="TouchStart",n[n.TouchMove_Departed=8]="TouchMove_Departed",n[n.TouchEnd=9]="TouchEnd",n[n.TouchCancel=10]="TouchCancel",(r=w=w||{}).Start="start",r.Pause="pause",r.Resume="resume",r.Resize="resize",r.Finish="finish",r.FullsnapshotRebuilded="fullsnapshot-rebuilded",r.LoadStylesheetStart="load-stylesheet-start",r.LoadStylesheetEnd="load-stylesheet-end",r.SkipStart="skip-start",r.SkipEnd="skip-end",r.MouseInteraction="mouse-interaction",r.EventCast="event-cast",r.CustomEvent="custom-event",r.Flush="flush",r.StateChange="state-change",r.PlayBack="play-back";var Br="Please stop import mirror directly. Instead of that,\r\nnow you can use replayer.getMirror() to access the mirror instance of a replayer,\r\nor you can use record.mirror to access the mirror instance during recording.",o={map:{},getId:function(){return console.error(Br),-1},getNode:function(){return console.error(Br),null},removeNodeFromMap:function(){console.error(Br)},has:function(){return console.error(Br),!1},reset:function(){console.error(Br)}};function zr(i,a,s){void 0===s&&(s={});var c=null,l=0;return function(e){var t=Date.now(),n=(l||!1!==s.leading||(l=t),a-(t-l)),r=this,o=arguments;n<=0||a<n?(c&&(clearTimeout(c),c=null),l=t,i.apply(r,o)):c||!1===s.trailing||(c=setTimeout(function(){l=!1===s.leading?0:Date.now(),c=null,i.apply(r,o)},n))}}function Wr(e,t,n,r,o){var i=(o=void 0===o?window:o).Object.getOwnPropertyDescriptor(e,t);return o.Object.defineProperty(e,t,r?n:{set:function(e){var t=this;setTimeout(function(){n.set.call(t,e)},0),i&&i.set&&i.set.call(this,e)}}),function(){return Wr(e,t,i||{},!0)}}function Vr(e,t,n){try{if(!(t in e))return function(){};var r=e[t],o=n(r);return"function"==typeof o&&(o.prototype=o.prototype||{},Object.defineProperties(o,{__rrweb_original__:{enumerable:!1,value:r}})),e[t]=o,function(){e[t]=r}}catch(e){return function(){}}}function Xr(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight}function qr(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth}function ue(e,t){return!!e&&(e.nodeType===e.ELEMENT_NODE?(n=!1,"string"==typeof t?n=e.classList.contains(t):e.classList.forEach(function(e){t.test(e)&&(n=!0)}),n||ue(e.parentNode,t)):(e.nodeType,e.TEXT_NODE,ue(e.parentNode,t)));var n}function Gr(e){return"__sn"in e&&e.__sn.id===hr}function Jr(e){return Boolean(e.changedTouches)}function Yr(e){"NodeList"in(e=void 0===e?window:e)&&!e.NodeList.prototype.forEach&&(e.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in e&&!e.DOMTokenList.prototype.forEach&&(e.DOMTokenList.prototype.forEach=Array.prototype.forEach),Node.prototype.contains||(Node.prototype.contains=function(e){if(!(0 in arguments))throw new TypeError("1 argument is required");do{if(this===e)return!0}while(e=e&&e.parentNode);return!1})}"undefined"!=typeof window&&window.Proxy&&window.Reflect&&new Proxy(o,{get:function(e,t,n){return"map"===t&&console.error(Br),Reflect.get(e,t,n)}});l.prototype.add=function(e){var t=this.indexes.get(e.parentId),e={id:e.node.id,mutation:e,children:[],texts:[],attributes:[]};t?(e.parent=t).children[e.id]=e:this.tree[e.id]=e,this.indexes.set(e.id,e)},l.prototype.remove=function(n,t){var r=this,e=this.indexes.get(n.parentId),o=this.indexes.get(n.id),i=function(e){r.removeIdSet.add(e);e=t.getNode(e);null!=e&&e.childNodes.forEach(function(e){"__sn"in e&&i(e.__sn.id)})},a=function(e){r.removeIdSet.add(e.id),Object.values(e.children).forEach(function(e){return a(e)});var t,e=r.indexes.get(e.id);e&&(t=e.parent)&&(delete e.parent,delete t.children[e.id],r.indexes.delete(n.id))};o?(e?(delete o.parent,delete e.children[o.id],this.indexes.delete(n.id)):(delete this.tree[o.id],this.indexes.delete(o.id)),a(o)):(this.removeNodeMutations.push(n),i(n.id))},l.prototype.text=function(e){var t=this.indexes.get(e.id);(t?t.texts:this.textMutations).push(e)},l.prototype.attribute=function(e){var t=this.indexes.get(e.id);(t?t.attributes:this.attributeMutations).push(e)},l.prototype.scroll=function(e){this.scrollMap.set(e.id,e)},l.prototype.input=function(e){this.inputMap.set(e.id,e)},l.prototype.flush=function(){var t,e,n,r,o=this,i=this.tree,a=this.removeNodeMutations,s=this.textMutations,c=this.attributeMutations,l={source:ce.Mutation,removes:a,texts:s,attributes:c,adds:[]},u=function(e,t){t&&o.removeIdSet.add(e.id),l.texts=l.texts.concat(t?[]:e.texts).filter(function(e){return!o.removeIdSet.has(e.id)}),l.attributes=l.attributes.concat(t?[]:e.attributes).filter(function(e){return!o.removeIdSet.has(e.id)}),o.removeIdSet.has(e.id)||o.removeIdSet.has(e.mutation.parentId)||t?Object.values(e.children).forEach(function(e){return u(e,!0)}):(l.adds.push(e.mutation),e.children&&Object.values(e.children).forEach(function(e){return u(e,!1)}))};Object.values(i).forEach(function(e){return u(e,!1)});try{for(var d=ae(this.scrollMap.keys()),p=d.next();!p.done;p=d.next()){var f=p.value;this.removeIdSet.has(f)&&this.scrollMap.delete(f)}}catch(e){t={error:e}}finally{try{p&&!p.done&&(e=d.return)&&e.call(d)}finally{if(t)throw t.error}}try{for(var h=ae(this.inputMap.keys()),m=h.next();!m.done;m=h.next()){f=m.value;this.removeIdSet.has(f)&&this.inputMap.delete(f)}}catch(e){n={error:e}}finally{try{m&&!m.done&&(r=h.return)&&r.call(h)}finally{if(n)throw n.error}}a=new Map(this.scrollMap),s=new Map(this.inputMap);return this.reset(),{mutationData:l,scrollMap:a,inputMap:s}},l.prototype.reset=function(){this.tree=[],this.indexes=new Map,this.removeNodeMutations=[],this.textMutations=[],this.attributeMutations=[],this.removeIdSet=new Set,this.scrollMap=new Map,this.inputMap=new Map},l.prototype.idRemoved=function(e){return this.removeIdSet.has(e)};var $r=l;function l(){this.reset()}function Qr(e){function t(e,t){return t={value:e,parent:t,children:[]},o[e.node.id]=t}var n,r,o={},i=[];try{for(var a=ae(e),s=a.next();!s.done;s=a.next()){var c,l,u,d=s.value,p=d.nextId,f=d.parentId;p&&p in o?(c=o[p]).parent?(l=c.parent.children.indexOf(c),c.parent.children.splice(l,0,t(d,c.parent))):(l=i.indexOf(c),i.splice(l,0,t(d,null))):f in o?(u=o[f]).children.push(t(d,u)):i.push(t(d,null))}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return i}function Kr(e){return"__sn"in e&&(e.__sn.type===I.Element&&"iframe"===e.__sn.tagName)}function Zr(e){return Boolean(null==(e=e)?void 0:e.shadowRoot)}function eo(e){return"__ln"in e}no.prototype.get=function(e){if(e>=this.length)throw new Error("Position outside of list range");for(var t=this.head,n=0;n<e;n++)t=(null==t?void 0:t.next)||null;return t},no.prototype.addNode=function(e){var t,n={value:e,previous:null,next:null};e.__ln=n,e.previousSibling&&eo(e.previousSibling)?(t=e.previousSibling.__ln.next,n.next=t,n.previous=e.previousSibling.__ln,e.previousSibling.__ln.next=n,t&&(t.previous=n)):e.nextSibling&&eo(e.nextSibling)&&e.nextSibling.__ln.previous?(t=e.nextSibling.__ln.previous,n.previous=t,n.next=e.nextSibling.__ln,e.nextSibling.__ln.previous=n,t&&(t.next=n)):(this.head&&(this.head.previous=n),n.next=this.head,this.head=n),this.length++},no.prototype.removeNode=function(e){var t=e.__ln;this.head&&(t.previous?(t.previous.next=t.next,t.next&&(t.next.previous=t.previous)):(this.head=t.next,this.head&&(this.head.previous=null)),e.__ln&&delete e.__ln,this.length--)};var to=no;function no(){this.length=0,this.head=null}function ro(e){return"__sn"in e}u.prototype.init=function(e,t,n,r,o,i,a,s,c,l,u,d,p,f,h){this.blockClass=t,this.blockSelector=n,this.maskTextClass=r,this.maskTextSelector=o,this.inlineStylesheet=i,this.maskInputOptions=a,this.maskTextFn=s,this.maskInputFn=c,this.recordCanvas=l,this.slimDOMOptions=u,this.emissionCallback=e,this.doc=d,this.mirror=p,this.iframeManager=f,this.shadowDomManager=h},u.prototype.freeze=function(){this.frozen=!0},u.prototype.unfreeze=function(){this.frozen=!1,this.emit()},u.prototype.isFrozen=function(){return this.frozen},u.prototype.lock=function(){this.locked=!0},u.prototype.unlock=function(){this.locked=!1,this.emit()};var oo=u;function u(){var w=this;this.frozen=!1,this.locked=!1,this.texts=[],this.attributes=[],this.removes=[],this.mapRemoves=[],this.movedMap={},this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.processMutations=function(e){e.forEach(w.processMutation),w.emit()},this.emit=function(){var t,n,e;if(!w.frozen&&!w.locked){for(var o=[],i=new to,a=function(e){for(var t=e,n=hr;n===hr;)n=(t=t&&t.nextSibling)&&w.mirror.getId(t);return n},r=function(t){var e=t.getRootNode?null==(e=t.getRootNode())?void 0:e.host:null,n=!(w.doc.contains(t)||e instanceof Node&&w.doc.contains(e));if(t.parentNode&&!n){n=ur(t.parentNode)?w.mirror.getId(e):w.mirror.getId(t.parentNode),e=a(t);if(-1===n||-1===e)return i.addNode(t);var r=Rr(t,{doc:w.doc,map:w.mirror.map,blockClass:w.blockClass,blockSelector:w.blockSelector,maskTextClass:w.maskTextClass,maskTextSelector:w.maskTextSelector,skipChild:!0,inlineStylesheet:w.inlineStylesheet,maskInputOptions:w.maskInputOptions,maskTextFn:w.maskTextFn,maskInputFn:w.maskInputFn,slimDOMOptions:w.slimDOMOptions,recordCanvas:w.recordCanvas,onSerialize:function(e){Kr(e)&&w.iframeManager.addIframe(e),Zr(t)&&w.shadowDomManager.addShadowRoot(t.shadowRoot,document)},onIframeLoad:function(e,t){w.iframeManager.attachIframe(e,t)}});r&&o.push({parentId:n,nextId:e,node:r})}};w.mapRemoves.length;)w.mirror.removeNodeFromMap(w.mapRemoves.shift());try{for(var s=ae(w.movedSet),c=s.next();!c.done;c=s.next()){var l=c.value;ao(w.removes,l,w.mirror)&&!w.movedSet.has(l.parentNode)||r(l)}}catch(e){t={error:e}}finally{try{c&&!c.done&&(g=s.return)&&g.call(s)}finally{if(t)throw t.error}}try{for(var u=ae(w.addedSet),d=u.next();!d.done;d=u.next()){l=d.value;!so(w.droppedSet,l)&&!ao(w.removes,l,w.mirror)||so(w.movedSet,l)?r(l):w.droppedSet.add(l)}}catch(e){n={error:e}}finally{try{d&&!d.done&&(e=u.return)&&e.call(u)}finally{if(n)throw n.error}}for(var p=null;i.length;){var f=null;if(p&&(v=w.mirror.getId(p.value.parentNode),y=a(p.value),-1!==v&&-1!==y&&(f=p)),!f)for(var h=i.length-1;0<=h;h--){var m=i.get(h);if(m){var v=w.mirror.getId(m.value.parentNode),y=a(m.value);if(-1!==v&&-1!==y){f=m;break}}}if(!f){for(;i.head;)i.removeNode(i.head.value);break}p=f.previous,i.removeNode(f.value),r(f.value)}var g={texts:w.texts.map(function(e){return{id:w.mirror.getId(e.node),value:e.value}}).filter(function(e){return w.mirror.has(e.id)}),attributes:w.attributes.map(function(e){return{id:w.mirror.getId(e.node),attributes:e.attributes}}).filter(function(e){return w.mirror.has(e.id)}),removes:w.removes,adds:o};(g.texts.length||g.attributes.length||g.removes.length||g.adds.length)&&(w.texts=[],w.attributes=[],w.removes=[],w.addedSet=new Set,w.movedSet=new Set,w.droppedSet=new Set,w.movedMap={},w.emissionCallback(g))}},this.processMutation=function(r){var t,e,n,o;if(!Gr(r.target))switch(r.type){case"characterData":var i=r.target.textContent;ue(r.target,w.blockClass)||i===r.oldValue||w.texts.push({value:Cr(r.target,w.maskTextClass,w.maskTextSelector)&&i?w.maskTextFn?w.maskTextFn(i):i.replace(/[\S]/g,"*"):i,node:r.target});break;case"attributes":var a=r.target,i=r.target.getAttribute(r.attributeName);if("value"===r.attributeName&&(i=dr({maskInputOptions:w.maskInputOptions,tagName:r.target.tagName,type:r.target.getAttribute("type"),value:i,maskInputFn:w.maskInputFn})),ue(r.target,w.blockClass)||i===r.oldValue)return;var s=w.attributes.find(function(e){return e.node===r.target});if(s||(s={node:r.target,attributes:{}},w.attributes.push(s)),"style"===r.attributeName){var c=w.doc.createElement("span"),l=(r.oldValue&&c.setAttribute("style",r.oldValue),void 0!==s.attributes.style&&null!==s.attributes.style||(s.attributes.style={}),s.attributes.style);try{for(var u=ae(Array.from(a.style)),d=u.next();!d.done;d=u.next()){var p=d.value,f=a.style.getPropertyValue(p),h=a.style.getPropertyPriority(p);f===c.style.getPropertyValue(p)&&h===c.style.getPropertyPriority(p)||(l[p]=""===h?f:[f,h])}}catch(e){t={error:e}}finally{try{d&&!d.done&&(e=u.return)&&e.call(u)}finally{if(t)throw t.error}}try{for(var m=ae(Array.from(c.style)),v=m.next();!v.done;v=m.next()){p=v.value;""===a.style.getPropertyValue(p)&&(l[p]=!1)}}catch(e){n={error:e}}finally{try{v&&!v.done&&(o=m.return)&&o.call(m)}finally{if(n)throw n.error}}}else s.attributes[r.attributeName]=Tr(w.doc,r.target.tagName,r.attributeName,i);break;case"childList":r.addedNodes.forEach(function(e){return w.genAdds(e,r.target)}),r.removedNodes.forEach(function(e){var t=w.mirror.getId(e),n=ur(r.target)?w.mirror.getId(r.target.host):w.mirror.getId(r.target);ue(r.target,w.blockClass)||Gr(e)||(w.addedSet.has(e)?(io(w.addedSet,e),w.droppedSet.add(e)):w.addedSet.has(r.target)&&-1===t||function e(t,n){if(ur(t))return!1;var r=n.getId(t);return!n.has(r)||(!t.parentNode||t.parentNode.nodeType!==t.DOCUMENT_NODE)&&(!t.parentNode||e(t.parentNode,n))}(r.target,w.mirror)||(w.movedSet.has(e)&&w.movedMap[t+"@"+n]?io(w.movedSet,e):w.removes.push({parentId:n,id:t,isShadow:!!ur(r.target)||void 0})),w.mapRemoves.push(e))})}},this.genAdds=function(e,t){if(!t||!ue(t,w.blockClass)){if(ro(e)){if(Gr(e))return;w.movedSet.add(e);var n=null;(n=t&&ro(t)?t.__sn.id:n)&&(w.movedMap[e.__sn.id+"@"+n]=!0)}else w.addedSet.add(e),w.droppedSet.delete(e);ue(e,w.blockClass)||e.childNodes.forEach(function(e){return w.genAdds(e)})}}}function io(t,e){t.delete(e),e.childNodes.forEach(function(e){return io(t,e)})}function ao(e,t,n){t=t.parentNode;if(!t)return!1;var r=n.getId(t);return!!e.some(function(e){return e.id===r})||ao(e,t,n)}function so(e,t){t=t.parentNode;return!!t&&(!!e.has(t)||so(e,t))}var co=[],lo="undefined"!=typeof CSSGroupingRule,uo="undefined"!=typeof CSSMediaRule,po="undefined"!=typeof CSSSupportsRule,fo="undefined"!=typeof CSSConditionRule;function ho(t){try{if("composedPath"in t){var e=t.composedPath();if(e.length)return e[0]}else if("path"in t&&t.path.length)return t.path[0];return t.target}catch(e){return t.target}}function mo(e,t,n,r,o,i,a,s,c,l,u,d,p,f,h,m){var v=new oo,e=(co.push(v),v.init(e,n,r,o,i,a,s,c,l,u,d,t,p,f,h),window.MutationObserver||window.__rrMutationObserver),i=null==(o=null==(r=null==(n=window)?void 0:n.Zone)?void 0:r.__symbol__)?void 0:o.call(r,"MutationObserver"),a=new(e=i&&window[i]?window[i]:e)(v.processMutations.bind(v));return a.observe(m,{attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),a}function vo(o,i,a,s,e){if(!1===e.mouseInteraction)return function(){};var t=!0===e.mouseInteraction||void 0===e.mouseInteraction?{}:e.mouseInteraction,c=[];return Object.keys(g).filter(function(e){return Number.isNaN(Number(e))&&!e.endsWith("_Departed")&&!1!==t[e]}).forEach(function(e){function t(e){var t,n=ho(e);ue(n,s)||(e=Jr(e)?e.changedTouches[0]:e)&&(n=a.getId(n),t=e.clientX,e=e.clientY,o({type:g[r],id:n,x:t,y:e}))}var r,n=e.toLowerCase();r=e;c.push(le(n,t,i))}),function(){c.forEach(function(e){return e()})}}function yo(r,o,i,a,e){return le("scroll",zr(function(e){var t,n,e=ho(e);e&&!ue(e,a)&&(t=i.getId(e),e===o?(n=o.scrollingElement||o.documentElement,r({id:t,x:n.scrollLeft,y:n.scrollTop})):r({id:t,x:e.scrollLeft,y:e.scrollTop}))},e.scroll||100),o)}function go(e,t){e=ie({},e);return t||delete e.userTriggered,e}var wo=["INPUT","TEXTAREA","SELECT"],bo=new WeakMap;function So(e){var t;return e=e,t=[],e=(lo&&e.parentRule instanceof CSSGroupingRule||uo&&e.parentRule instanceof CSSMediaRule||po&&e.parentRule instanceof CSSSupportsRule||fo&&e.parentRule instanceof CSSConditionRule?Array.from(e.parentRule.cssRules):Array.from(e.parentStyleSheet.cssRules)).indexOf(e),t.unshift(e),t}function _o(n,r,o){function e(t){return function(e){e=ho(e);e&&!ue(e,r)&&n({type:t,id:o.getId(e),currentTime:e.currentTime})}}var t=[le("play",e(0)),le("pause",e(1)),le("seeked",e(2))];return function(){t.forEach(function(e){return e()})}}function xo(a,n,s,c){var t,e,r=Object.getOwnPropertyNames(n.CanvasRenderingContext2D.prototype),o=[];try{for(var i=ae(r),l=i.next();!l.done;l=i.next())!function(i){try{if("function"!=typeof n.CanvasRenderingContext2D.prototype[i])return;var t=Vr(n.CanvasRenderingContext2D.prototype,i,function(t){return function(){for(var r=this,o=[],e=0;e<arguments.length;e++)o[e]=arguments[e];return ue(this.canvas,s)||setTimeout(function(){var e,t,n=se(o);"drawImage"===i&&n[0]&&n[0]instanceof HTMLCanvasElement&&(t=null==(e=null==(e=(t=n[0]).getContext("2d"))?void 0:e.getImageData(0,0,t.width,t.height))?void 0:e.data,n[0]=JSON.stringify(t)),a({id:c.getId(r.canvas),property:i,args:n})},0),t.apply(this,o)}});o.push(t)}catch(e){t=Wr(n.CanvasRenderingContext2D.prototype,i,{set:function(e){a({id:c.getId(this.canvas),property:i,args:[e],setter:!0})}});o.push(t)}}(l.value)}catch(e){t={error:e}}finally{try{l&&!l.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}return function(){o.forEach(function(e){return e()})}}function Eo(e,t){var n,r,o,i,a,s,c,l,u,d,p,f,F,P,h=e.doc.defaultView;if(!h)return function(){};o=t=void 0===t?{}:t,i=(t=e).mutationCb,a=t.mousemoveCb,s=t.mouseInteractionCb,c=t.scrollCb,l=t.viewportResizeCb,u=t.inputCb,d=t.mediaInteractionCb,p=t.styleSheetRuleCb,f=t.styleDeclarationCb,F=t.canvasMutationCb,P=t.fontCb,t.mutationCb=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];o.mutation&&o.mutation.apply(o,se(e)),i.apply(void 0,se(e))},t.mousemoveCb=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];o.mousemove&&o.mousemove.apply(o,se(e)),a.apply(void 0,se(e))},t.mouseInteractionCb=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];o.mouseInteraction&&o.mouseInteraction.apply(o,se(e)),s.apply(void 0,se(e))},t.scrollCb=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];o.scroll&&o.scroll.apply(o,se(e)),c.apply(void 0,se(e))},t.viewportResizeCb=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];o.viewportResize&&o.viewportResize.apply(o,se(e)),l.apply(void 0,se(e))},t.inputCb=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];o.input&&o.input.apply(o,se(e)),u.apply(void 0,se(e))},t.mediaInteractionCb=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];o.mediaInteaction&&o.mediaInteaction.apply(o,se(e)),d.apply(void 0,se(e))},t.styleSheetRuleCb=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];o.styleSheetRule&&o.styleSheetRule.apply(o,se(e)),p.apply(void 0,se(e))},t.styleDeclarationCb=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];o.styleDeclaration&&o.styleDeclaration.apply(o,se(e)),f.apply(void 0,se(e))},t.canvasMutationCb=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];o.canvasMutation&&o.canvasMutation.apply(o,se(e)),F.apply(void 0,se(e))},t.fontCb=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];o.font&&o.font.apply(o,se(e)),P.apply(void 0,se(e))};var j,m,v,H,y,U,B,z,g,W,w,b,V,X=mo(e.mutationCb,e.doc,e.blockClass,e.blockSelector,e.maskTextClass,e.maskTextSelector,e.inlineStylesheet,e.maskInputOptions,e.maskTextFn,e.maskInputFn,e.recordCanvas,e.slimDOMOptions,e.mirror,e.iframeManager,e.shadowDomManager,e.doc),q=function(n,e,t,o){if(!1===e.mousemove)return function(){};var i,r="number"==typeof e.mousemove?e.mousemove:50,e="number"==typeof e.mousemoveCallback?e.mousemoveCallback:500,a=[],s=zr(function(e){var t=Date.now()-i;n(a.map(function(e){return e.timeOffset-=t,e}),e),a=[],i=null},e),c=[le("mousemove",e=zr(function(e){var t=ho(e),n=Jr(e)?e.changedTouches[0]:e,r=n.clientX,n=n.clientY;i=i||Date.now(),a.push({x:r,y:n,id:o.getId(t),timeOffset:Date.now()-i}),s("undefined"!=typeof DragEvent&&e instanceof DragEvent?ce.Drag:e instanceof MouseEvent?ce.MouseMove:ce.TouchMove)},r,{trailing:!1}),t),le("touchmove",e,t),le("drag",e,t)];return function(){c.forEach(function(e){return e()})}}(e.mousemoveCb,e.sampling,e.doc,e.mirror),G=vo(e.mouseInteractionCb,e.doc,e.mirror,e.blockClass,e.sampling),J=yo(e.scrollCb,e.doc,e.mirror,e.blockClass,e.sampling),Y=(j=e.viewportResizeCb,v=m=-1,le("resize",zr(function(){var e=Xr(),t=qr();m===e&&v===t||(j({width:Number(t),height:Number(e)}),m=e,v=t)},200),window)),$=(H=e.inputCb,y=e.doc,U=e.mirror,B=e.blockClass,z=e.ignoreClass,g=e.maskInputOptions,W=e.maskInputFn,t=e.sampling,w=e.userTriggeredOnInput,b=("last"===t.input?["change"]:["input","change"]).map(function(e){return le(e,Q,y)}),t=Object.getOwnPropertyDescriptor(HTMLInputElement.prototype,"value"),V=[[HTMLInputElement.prototype,"value"],[HTMLInputElement.prototype,"checked"],[HTMLSelectElement.prototype,"value"],[HTMLTextAreaElement.prototype,"value"],[HTMLSelectElement.prototype,"selectedIndex"]],t&&t.set&&b.push.apply(b,se(V.map(function(e){return Wr(e[0],e[1],{set:function(){Q({target:this})}})}))),function(){b.forEach(function(e){return e()})});function Q(e){var t,n,r,o=ho(e),e=e.isTrusted;!o||!o.tagName||wo.indexOf(o.tagName)<0||ue(o,B)||(t=o.type,o.classList.contains(z)||(r=o.value,n=!1,"radio"===t||"checkbox"===t?n=o.checked:(g[o.tagName.toLowerCase()]||g[t])&&(r=dr({maskInputOptions:g,tagName:o.tagName,type:t,value:r,maskInputFn:W})),K(o,go({text:r,isChecked:n,userTriggered:e},w)),r=o.name,"radio"===t&&r&&n&&y.querySelectorAll('input[type="radio"][name="'+r+'"]').forEach(function(e){e!==o&&K(e,go({text:e.value,isChecked:!n,userTriggered:!1},w))})))}function K(e,t){var n=bo.get(e);n&&n.text===t.text&&n.isChecked===t.isChecked||(bo.set(e,t),n=U.getId(e),H(ie(ie({},t),{id:n})))}var S,_,x,E,T,C,O,R,I,k,N,M,Z=_o(e.mediaInteractionCb,e.blockClass,e.mirror),ee=(S=e.styleSheetRuleCb,_=h,x=e.mirror,E=_.CSSStyleSheet.prototype.insertRule,_.CSSStyleSheet.prototype.insertRule=function(e,t){var n=x.getId(this.ownerNode);return-1!==n&&S({id:n,adds:[{rule:e,index:t}]}),E.apply(this,arguments)},T=_.CSSStyleSheet.prototype.deleteRule,_.CSSStyleSheet.prototype.deleteRule=function(e){var t=x.getId(this.ownerNode);return-1!==t&&S({id:t,removes:[{index:e}]}),T.apply(this,arguments)},C={},lo?C.CSSGroupingRule=_.CSSGroupingRule:(uo&&(C.CSSMediaRule=_.CSSMediaRule),fo&&(C.CSSConditionRule=_.CSSConditionRule),po&&(C.CSSSupportsRule=_.CSSSupportsRule)),O={},Object.entries(C).forEach(function(e){var e=cr(e,2),r=e[0],e=e[1];O[r]={insertRule:e.prototype.insertRule,deleteRule:e.prototype.deleteRule},e.prototype.insertRule=function(e,t){var n=x.getId(this.parentStyleSheet.ownerNode);return-1!==n&&S({id:n,adds:[{rule:e,index:se(So(this),[t||0])}]}),O[r].insertRule.apply(this,arguments)},e.prototype.deleteRule=function(e){var t=x.getId(this.parentStyleSheet.ownerNode);return-1!==t&&S({id:t,removes:[{index:se(So(this),[e])}]}),O[r].deleteRule.apply(this,arguments)}}),function(){_.CSSStyleSheet.prototype.insertRule=E,_.CSSStyleSheet.prototype.deleteRule=T,Object.entries(C).forEach(function(e){var e=cr(e,2),t=e[0],e=e[1];e.prototype.insertRule=O[t].insertRule,e.prototype.deleteRule=O[t].deleteRule})}),te=(R=e.styleDeclarationCb,I=h,k=e.mirror,N=I.CSSStyleDeclaration.prototype.setProperty,I.CSSStyleDeclaration.prototype.setProperty=function(e,t,n){var r=k.getId(null==(r=null==(r=this.parentRule)?void 0:r.parentStyleSheet)?void 0:r.ownerNode);return-1!==r&&R({id:r,set:{property:e,value:t,priority:n},index:So(this.parentRule)}),N.apply(this,arguments)},M=I.CSSStyleDeclaration.prototype.removeProperty,I.CSSStyleDeclaration.prototype.removeProperty=function(e){var t=k.getId(null==(t=null==(t=this.parentRule)?void 0:t.parentStyleSheet)?void 0:t.ownerNode);return-1!==t&&R({id:t,remove:{property:e},index:So(this.parentRule)}),M.apply(this,arguments)},function(){I.CSSStyleDeclaration.prototype.setProperty=N,I.CSSStyleDeclaration.prototype.removeProperty=M}),ne=e.recordCanvas?xo(e.canvasMutationCb,h,e.blockClass,e.mirror):function(){},re=e.collectFonts?function(n,e){var t=e.defaultView;if(!t)return function(){};var r=[],o=new WeakMap,i=t.FontFace,e=(t.FontFace=function(e,t,n){var r=new i(e,t,n);return o.set(r,{family:e,buffer:"string"!=typeof t,descriptors:n,fontSource:"string"==typeof t?t:JSON.stringify(Array.from(new Uint8Array(t)))}),r},Vr(e.fonts,"add",function(e){return function(t){return setTimeout(function(){var e=o.get(t);e&&(n(e),o.delete(t))},0),e.apply(this,[t])}}));return r.push(function(){t.FontFace=i}),r.push(e),function(){r.forEach(function(e){return e()})}}(e.fontCb,e.doc):function(){},oe=[];try{for(var D=ae(e.plugins),A=D.next();!A.done;A=D.next()){var L=A.value;oe.push(L.observer(L.callback,h,L.options))}}catch(e){n={error:e}}finally{try{A&&!A.done&&(r=D.return)&&r.call(D)}finally{if(n)throw n.error}}return function(){X.disconnect(),q(),G(),J(),Y(),$(),Z(),ee(),te(),ne(),re(),oe.forEach(function(e){return e()})}}Co.prototype.addIframe=function(e){this.iframes.set(e,!0)},Co.prototype.addLoadListener=function(e){this.loadListener=e},Co.prototype.attachIframe=function(e,t){this.mutationCb({adds:[{parentId:e.__sn.id,nextId:null,node:t}],removes:[],texts:[],attributes:[],isAttachIframe:!0}),null!=(t=this.loadListener)&&t.call(this,e)};var To=Co;function Co(e){this.iframes=new WeakMap,this.mutationCb=e.mutationCb}Io.prototype.addShadowRoot=function(e,t){mo(this.mutationCb,t,this.bypassOptions.blockClass,this.bypassOptions.blockSelector,this.bypassOptions.maskTextClass,this.bypassOptions.maskTextSelector,this.bypassOptions.inlineStylesheet,this.bypassOptions.maskInputOptions,this.bypassOptions.maskTextFn,this.bypassOptions.maskInputFn,this.bypassOptions.recordCanvas,this.bypassOptions.slimDOMOptions,this.mirror,this.bypassOptions.iframeManager,this,e),yo(this.scrollCb,e,this.mirror,this.bypassOptions.blockClass,this.bypassOptions.sampling)};var P,Oo,Ro=Io;function Io(e){this.mutationCb=e.mutationCb,this.scrollCb=e.scrollCb,this.bypassOptions=e.bypassOptions,this.mirror=e.mirror}function j(e){return ie(ie({},e),{timestamp:Date.now()})}var ko=Ur();function No(e){var r=(e=void 0===e?{}:e).emit,o=e.checkoutEveryNms,i=e.checkoutEveryNth,t=e.blockClass,v=void 0===t?"rr-block":t,t=e.blockSelector,y=void 0===t?null:t,t=e.ignoreClass,n=void 0===t?"rr-ignore":t,t=e.maskTextClass,g=void 0===t?"rr-mask":t,t=e.maskTextSelector,w=void 0===t?null:t,t=e.inlineStylesheet,b=void 0===t||t,t=e.maskAllInputs,a=e.maskInputOptions,s=e.slimDOMOptions,c=e.maskInputFn,S=e.maskTextFn,l=e.hooks,u=e.packFn,d=e.sampling,p=void 0===d?{}:d,d=e.mousemoveWait,f=e.recordCanvas,_=void 0!==f&&f,f=e.userTriggeredOnInput,h=void 0!==f&&f,f=e.collectFonts,m=void 0!==f&&f,x=e.plugins,f=e.keepIframeSrcFn,E=void 0===f?function(){return!1}:f;if(!r)throw new Error("emit function is required");void 0!==d&&void 0===p.mousemove&&(p.mousemove=d);function T(e){P(j({type:F.IncrementalSnapshot,data:ie({source:ce.Mutation},e)}))}function C(e){return P(j({type:F.IncrementalSnapshot,data:ie({source:ce.Scroll},e)}))}var O,R=!0===t?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:void 0!==a?a:{password:!0},I=!0===s||"all"===s?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaVerification:!0,headMetaAuthorship:"all"===s,headMetaDescKeywords:"all"===s}:s||{},k=(Yr(),0),N=(P=function(e,t){var n;null==(n=co[0])||!n.isFrozen()||e.type===F.FullSnapshot||e.type===F.IncrementalSnapshot&&e.data.source===ce.Mutation||co.forEach(function(e){return e.unfreeze()}),r(u?u(e):e,t),e.type===F.FullSnapshot?(O=e,k=0):e.type!==F.IncrementalSnapshot||e.data.source===ce.Mutation&&e.data.isAttachIframe||(k++,n=i&&i<=k,t=o&&e.timestamp-O.timestamp>o,(n||t)&&Oo(!0))},new To({mutationCb:T})),M=new Ro({mutationCb:T,scrollCb:C,bypassOptions:{blockClass:v,blockSelector:y,maskTextClass:g,maskTextSelector:w,inlineStylesheet:b,maskInputOptions:R,maskTextFn:S,maskInputFn:c,recordCanvas:_,sampling:p,slimDOMOptions:I,iframeManager:N},mirror:ko});Oo=function(e){void 0===e&&(e=!1),P(j({type:F.Meta,data:{href:window.location.href,width:qr(),height:Xr()}}),e),co.forEach(function(e){return e.lock()});var t,n,r,o,i,a,s,c,l,u,d,p,f=cr((e=document,f=(t=(t={blockClass:v,blockSelector:y,maskTextClass:g,maskTextSelector:w,inlineStylesheet:b,maskAllInputs:R,maskTextFn:S,slimDOM:I,recordCanvas:_,onSerialize:function(e){Kr(e)&&N.addIframe(e),Zr(e)&&M.addShadowRoot(e.shadowRoot,document)},onIframeLoad:function(e,t){N.attachIframe(e,t)},keepIframeSrcFn:E})||{}).blockClass,h=t.blockSelector,m=t.maskTextClass,n=t.maskTextSelector,r=t.inlineStylesheet,o=t.recordCanvas,i=void 0!==(i=t.maskAllInputs)&&i,a=t.maskTextFn,s=t.maskInputFn,c=void 0!==(c=t.slimDOM)&&c,l=t.preserveWhiteSpace,u=t.onSerialize,d=t.onIframeLoad,p=t.iframeLoadTimeout,t=t.keepIframeSrcFn,[Rr(e,{doc:e,map:e={},blockClass:void 0===f?"rr-block":f,blockSelector:void 0===h?null:h,maskTextClass:void 0===m?"rr-mask":m,maskTextSelector:void 0===n?null:n,skipChild:!1,inlineStylesheet:void 0===r||r,maskInputOptions:!0===i?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:!1===i?{password:!0}:i,maskTextFn:a,maskInputFn:s,slimDOMOptions:!0===c||"all"===c?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaDescKeywords:"all"===c,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaAuthorship:!0,headMetaVerification:!0}:!1===c?{}:c,recordCanvas:void 0!==o&&o,preserveWhiteSpace:l,onSerialize:u,onIframeLoad:d,iframeLoadTimeout:p,keepIframeSrcFn:void 0===t?function(){return!1}:t}),e]),2),h=f[0],m=f[1];if(!h)return console.warn("Failed to snapshot the document");ko.map=m,P(j({type:F.FullSnapshot,data:{node:h,initialOffset:{left:void 0!==window.pageXOffset?window.pageXOffset:(null===document||void 0===document?void 0:document.documentElement.scrollLeft)||(null==(r=null==(n=null===document||void 0===document?void 0:document.body)?void 0:n.parentElement)?void 0:r.scrollLeft)||(null===document||void 0===document?void 0:document.body.scrollLeft)||0,top:void 0!==window.pageYOffset?window.pageYOffset:(null===document||void 0===document?void 0:document.documentElement.scrollTop)||(null==(a=null==(i=null===document||void 0===document?void 0:document.body)?void 0:i.parentElement)?void 0:a.scrollTop)||(null===document||void 0===document?void 0:document.body.scrollTop)||0}}})),co.forEach(function(e){return e.unlock()})};try{var D=[],A=(D.push(le("DOMContentLoaded",function(){P(j({type:F.DomContentLoaded,data:{}}))})),function(e){return Eo({mutationCb:T,mousemoveCb:function(e,t){return P(j({type:F.IncrementalSnapshot,data:{source:t,positions:e}}))},mouseInteractionCb:function(e){return P(j({type:F.IncrementalSnapshot,data:ie({source:ce.MouseInteraction},e)}))},scrollCb:C,viewportResizeCb:function(e){return P(j({type:F.IncrementalSnapshot,data:ie({source:ce.ViewportResize},e)}))},inputCb:function(e){return P(j({type:F.IncrementalSnapshot,data:ie({source:ce.Input},e)}))},mediaInteractionCb:function(e){return P(j({type:F.IncrementalSnapshot,data:ie({source:ce.MediaInteraction},e)}))},styleSheetRuleCb:function(e){return P(j({type:F.IncrementalSnapshot,data:ie({source:ce.StyleSheetRule},e)}))},styleDeclarationCb:function(e){return P(j({type:F.IncrementalSnapshot,data:ie({source:ce.StyleDeclaration},e)}))},canvasMutationCb:function(e){return P(j({type:F.IncrementalSnapshot,data:ie({source:ce.CanvasMutation},e)}))},fontCb:function(e){return P(j({type:F.IncrementalSnapshot,data:ie({source:ce.Font},e)}))},blockClass:v,ignoreClass:n,maskTextClass:g,maskTextSelector:w,maskInputOptions:R,inlineStylesheet:b,sampling:p,recordCanvas:_,userTriggeredOnInput:h,collectFonts:m,doc:e,maskInputFn:c,maskTextFn:S,blockSelector:y,slimDOMOptions:I,mirror:ko,iframeManager:N,shadowDomManager:M,plugins:(null==x?void 0:x.map(function(t){return{observer:t.observer,options:t.options,callback:function(e){return P(j({type:F.Plugin,data:{plugin:t.name,payload:e}}))}}}))||[]},l)}),L=(N.addLoadListener(function(e){D.push(A(e.contentDocument))}),function(){Oo(),D.push(A(document))});return"interactive"===document.readyState||"complete"===document.readyState?L():D.push(le("load",function(){P(j({type:F.Load,data:{}})),L()},window)),function(){D.forEach(function(e){return e()})}}catch(e){console.warn(e)}}function Mo(r){return r=r||Object.create(null),{on:function(e,t){(r[e]||(r[e]=[])).push(t)},off:function(e,t){r[e]&&r[e].splice(r[e].indexOf(t)>>>0,1)},emit:function(t,n){(r[t]||[]).slice().map(function(e){e(n)}),(r["*"]||[]).slice().map(function(e){e(t,n)})}}}No.addCustomEvent=function(e,t){if(!P)throw new Error("please add custom event after start recording");P(j({type:F.Custom,data:{tag:e,payload:t}}))},No.freezePage=function(){co.forEach(function(e){return e.freeze()})},No.takeFullSnapshot=function(e){if(!Oo)throw new Error("please take full snapshot after start recording");Oo(e)},No.mirror=ko;function Do(s,c){var e,r,l,u,n,t;function d(e,t){this.scrollLeft=e,this.scrollTop=t}function o(e){if(null===e||"object"!=typeof e||void 0===e.behavior||"auto"===e.behavior||"instant"===e.behavior)return!0;if("object"==typeof e&&"smooth"===e.behavior)return!1;throw new TypeError("behavior member of ScrollOptions "+e.behavior+" is not a valid value for enumeration ScrollBehavior.")}function i(e,t){return"Y"===t?e.clientHeight+n<e.scrollHeight:"X"===t?e.clientWidth+n<e.scrollWidth:void 0}function a(e,t){e=s.getComputedStyle(e,null)["overflow"+t];return"auto"===e||"scroll"===e}function p(e){for(;e!==c.body&&!1===(n=void 0,n=i(t=e,"Y")&&a(t,"Y"),t=i(t,"X")&&a(t,"X"),n||t);)e=e.parentNode||e.host;var t,n;return e}function f(e){var t,n=(u()-e.startTime)/r;n=n=1<n?1:n,n=.5*(1-Math.cos(Math.PI*n)),t=e.startX+(e.x-e.startX)*n,n=e.startY+(e.y-e.startY)*n,e.method.call(e.scrollable,t,n),t===e.x&&n===e.y||s.requestAnimationFrame(f.bind(s,e))}function h(e,t,n){var r,o,i,a=u(),e=e===c.body?(o=(r=s).scrollX||s.pageXOffset,i=s.scrollY||s.pageYOffset,l.scroll):(o=(r=e).scrollLeft,i=e.scrollTop,d);f({scrollable:r,method:e,startTime:a,startX:o,startY:i,x:t,y:n})}void 0===s&&(s=window),"scrollBehavior"in(c=void 0===c?document:c).documentElement.style&&!0!==s.__forceSmoothScrollPolyfill__||(e=s.HTMLElement||s.Element,r=468,l={scroll:s.scroll||s.scrollTo,scrollBy:s.scrollBy,elementScroll:e.prototype.scroll||d,scrollIntoView:e.prototype.scrollIntoView},u=s.performance&&s.performance.now?s.performance.now.bind(s.performance):Date.now,t=s.navigator.userAgent,n=new RegExp(["MSIE ","Trident/","Edge/"].join("|")).test(t)?1:0,s.scroll=s.scrollTo=function(){void 0!==arguments[0]&&(!0===o(arguments[0])?l.scroll.call(s,void 0!==arguments[0].left?arguments[0].left:"object"!=typeof arguments[0]?arguments[0]:s.scrollX||s.pageXOffset,void 0!==arguments[0].top?arguments[0].top:void 0!==arguments[1]?arguments[1]:s.scrollY||s.pageYOffset):h.call(s,c.body,void 0!==arguments[0].left?~~arguments[0].left:s.scrollX||s.pageXOffset,void 0!==arguments[0].top?~~arguments[0].top:s.scrollY||s.pageYOffset))},s.scrollBy=function(){void 0!==arguments[0]&&(o(arguments[0])?l.scrollBy.call(s,void 0!==arguments[0].left?arguments[0].left:"object"!=typeof arguments[0]?arguments[0]:0,void 0!==arguments[0].top?arguments[0].top:void 0!==arguments[1]?arguments[1]:0):h.call(s,c.body,~~arguments[0].left+(s.scrollX||s.pageXOffset),~~arguments[0].top+(s.scrollY||s.pageYOffset)))},e.prototype.scroll=e.prototype.scrollTo=function(){if(void 0!==arguments[0])if(!0===o(arguments[0])){if("number"==typeof arguments[0]&&void 0===arguments[1])throw new SyntaxError("Value could not be converted");l.elementScroll.call(this,void 0!==arguments[0].left?~~arguments[0].left:"object"!=typeof arguments[0]?~~arguments[0]:this.scrollLeft,void 0!==arguments[0].top?~~arguments[0].top:void 0!==arguments[1]?~~arguments[1]:this.scrollTop)}else{var e=arguments[0].left,t=arguments[0].top;h.call(this,this,void 0===e?this.scrollLeft:~~e,void 0===t?this.scrollTop:~~t)}},e.prototype.scrollBy=function(){void 0!==arguments[0]&&(!0===o(arguments[0])?l.elementScroll.call(this,void 0!==arguments[0].left?~~arguments[0].left+this.scrollLeft:~~arguments[0]+this.scrollLeft,void 0!==arguments[0].top?~~arguments[0].top+this.scrollTop:~~arguments[1]+this.scrollTop):this.scroll({left:~~arguments[0].left+this.scrollLeft,top:~~arguments[0].top+this.scrollTop,behavior:arguments[0].behavior}))},e.prototype.scrollIntoView=function(){var e,t,n;!0===o(arguments[0])?l.scrollIntoView.call(this,void 0===arguments[0]||arguments[0]):(t=(e=p(this)).getBoundingClientRect(),n=this.getBoundingClientRect(),e!==c.body?(h.call(this,e,e.scrollLeft+n.left-t.left,e.scrollTop+n.top-t.top),"fixed"!==s.getComputedStyle(e).position&&s.scrollBy({left:t.left,top:t.top,behavior:"smooth"})):s.scrollBy({left:n.left,top:n.top,behavior:"smooth"}))})}d.prototype.addAction=function(e){var t=this.findActionIndex(e);this.actions.splice(t,0,e)},d.prototype.addActions=function(e){this.actions=this.actions.concat(e)},d.prototype.start=function(){this.timeOffset=0;var r=performance.now(),o=this.actions,i=this;this.raf=requestAnimationFrame(function e(){var t=performance.now();for(i.timeOffset+=(t-r)*i.speed,r=t;o.length;){var n=o[0];if(!(i.timeOffset>=n.delay))break;o.shift(),n.doAction()}(0<o.length||i.liveMode)&&(i.raf=requestAnimationFrame(e))})},d.prototype.clear=function(){this.raf&&(cancelAnimationFrame(this.raf),this.raf=null),this.actions.length=0},d.prototype.setSpeed=function(e){this.speed=e},d.prototype.toggleLiveMode=function(e){this.liveMode=e},d.prototype.isActive=function(){return null!==this.raf},d.prototype.findActionIndex=function(e){for(var t=0,n=this.actions.length-1;t<=n;){var r=Math.floor((t+n)/2);if(this.actions[r].delay<e.delay)t=r+1;else{if(!(this.actions[r].delay>e.delay))return r+1;n=r-1}}return t};var Ao,Lo=d;function d(e,t){void 0===e&&(e=[]),this.timeOffset=0,this.raf=null,this.actions=e,this.speed=t}function Fo(e,t){var n;if(e.type===F.IncrementalSnapshot&&e.data.source===ce.MouseMove)return n=e.data.positions[0].timeOffset,n=e.timestamp+n,void(e.delay=n-t);e.delay=e.timestamp-t,e.delay}function Po(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}(e=Ao=Ao||{})[e.NotStarted=0]="NotStarted",e[e.Running=1]="Running",e[e.Stopped=2]="Stopped";var jo={type:"xstate.init"};function Ho(e){return void 0===e?[]:[].concat(e)}function Uo(e){return{type:"xstate.assign",assignment:e}}function Bo(e,t){return"string"==typeof(e="string"==typeof e&&t&&t[e]?t[e]:e)?{type:e}:"function"==typeof e?{type:e.name,exec:e}:e}function zo(t){return function(e){return t===e}}function Wo(e){return"string"==typeof e?{type:e}:e}function Vo(e,t){return{value:e,context:t,actions:[],changed:!1,matches:zo(e)}}function Xo(e,t,r){var o=t,i=!1;return[e.filter(function(t){var n;return"xstate.assign"!==t.type||(i=!0,n=Object.assign({},o),"function"==typeof t.assignment?n=t.assignment(o,r):Object.keys(t.assignment).forEach(function(e){n[e]="function"==typeof t.assignment[e]?t.assignment[e](o,r):t.assignment[e]}),o=n,!1)}),o,i]}function qo(T,t){void 0===t&&(t={});var e=Po(Xo(Ho(T.states[T.initial].entry).map(function(e){return Bo(e,t.actions)}),T.context,jo),2),n=e[0],e=e[1],C={config:T,_options:t,initialState:{value:T.initial,actions:n,context:e,matches:zo(T.initial)},transition:function(e,t){var n,r,e="string"==typeof e?{value:e,context:T.context}:e,o=e.value,i=e.context,a=Wo(t),s=T.states[o];if(s.on){e=Ho(s.on[a.type]);try{for(var c=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&r>=e.length?void 0:e)&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),l=c.next();!l.done;l=c.next()){var u=l.value;if(void 0===u)return Vo(o,i);var d,p,f,h,m,v="string"==typeof u?{target:u}:u,y=v.target,g=v.actions,w=void 0===g?[]:g,b=v.cond,S=void 0===b?function(){return!0}:b,_=void 0===y,x=null!=y?y:o,E=T.states[x];if(S(i,a))return p=(d=Po(Xo((_?Ho(w):[].concat(s.exit,w,E.entry).filter(function(e){return e})).map(function(e){return Bo(e,C._options.actions)}),i,a),3))[0],f=d[1],h=d[2],{value:m=null!=y?y:o,context:f,actions:p,changed:y!==o||0<p.length||h,matches:zo(m)}}}catch(e){n={error:e}}finally{try{l&&!l.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}}return Vo(o,i)}};return C}function Go(t,n){t.actions.forEach(function(e){e=e.exec;return e&&e(t.context,n)})}function Jo(t){var n=t.initialState,r=Ao.NotStarted,o=new Set,i={_machine:t,send:function(e){r===Ao.Running&&(n=t.transition(n,e),Go(n,Wo(e)),o.forEach(function(e){return e(n)}))},subscribe:function(e){return o.add(e),e(n),{unsubscribe:function(){return o.delete(e)}}},start:function(e){return e&&(e="object"==typeof e?e:{context:t.config.context,value:e},n={value:e.value,actions:[],context:e.context,matches:zo(e.value)}),r=Ao.Running,Go(n,jo),i},stop:function(){return r=Ao.Stopped,o.clear(),i},get state(){return n},get status(){return r}};return i}function Yo(e,t){var v=t.getCastFn,y=t.applyEventsSynchronously,g=t.emitter;return Jo(qo({id:"player",context:e,initial:"paused",states:{playing:{on:{PAUSE:{target:"paused",actions:["pause"]},CAST_EVENT:{target:"playing",actions:"castEvent"},END:{target:"paused",actions:["resetLastPlayedEvent","pause"]},ADD_EVENT:{target:"playing",actions:["addEvent"]}}},paused:{on:{PLAY:{target:"playing",actions:["recordTimeOffset","play"]},CAST_EVENT:{target:"paused",actions:"castEvent"},TO_LIVE:{target:"live",actions:["startLive"]},ADD_EVENT:{target:"paused",actions:["addEvent"]}}},live:{on:{ADD_EVENT:{target:"live",actions:["addEvent"]},CAST_EVENT:{target:"live",actions:["castEvent"]}}}}},{actions:{castEvent:Uo({lastPlayedEvent:function(e,t){return"CAST_EVENT"===t.type?t.payload.event:e.lastPlayedEvent}}),recordTimeOffset:Uo(function(e,t){var n=e.timeOffset;return"payload"in t&&"timeOffset"in t.payload&&(n=t.payload.timeOffset),ie(ie({},e),{timeOffset:n,baselineTime:e.events[0].timestamp+n})}),play:function(e){var t,n,r,o,i=e.timer,a=e.events,s=e.baselineTime,c=e.lastPlayedEvent;i.clear();try{for(var l=ae(a),u=l.next();!u.done;u=l.next())Fo(u.value,s)}catch(e){t={error:e}}finally{try{u&&!u.done&&(o=l.return)&&o.call(l)}finally{if(t)throw t.error}}var e=function(e,t){for(var n=e.length-1;0<=n;n--){var r=e[n];if(r.type===F.Meta&&r.timestamp<=t)return e.slice(n)}return e}(a,s),d=null==c?void 0:c.timestamp,p=((null==c?void 0:c.type)===F.IncrementalSnapshot&&c.data.source===ce.MouseMove&&(d=c.timestamp+(null==(o=c.data.positions[0])?void 0:o.timeOffset)),s<(d||0)&&g.emit(w.PlayBack),new Array),f=new Array;try{for(var h=ae(e),m=h.next();!m.done;m=h.next())!function(e){if(d&&d<s&&(e.timestamp<=d||e===c))return;var t;e.timestamp<s?p.push(e):(t=v(e,!1),f.push({doAction:function(){t(),g.emit(w.EventCast,e)},delay:e.delay}))}(m.value)}catch(e){n={error:e}}finally{try{m&&!m.done&&(r=h.return)&&r.call(h)}finally{if(n)throw n.error}}y(p),g.emit(w.Flush),i.addActions(f),i.start()},pause:function(e){e.timer.clear()},resetLastPlayedEvent:Uo(function(e){return ie(ie({},e),{lastPlayedEvent:null})}),startLive:Uo({baselineTime:function(e,t){return e.timer.toggleLiveMode(!0),e.timer.start(),"TO_LIVE"===t.type&&t.payload.baselineTime?t.payload.baselineTime:Date.now()}}),addEvent:Uo(function(e,t){var n=e.baselineTime,r=e.timer,o=e.events;if("ADD_EVENT"===t.type){var i=t.payload.event,a=(Fo(i,n),o.length-1);if(!o[a]||o[a].timestamp<=i.timestamp)o.push(i);else{for(var t=-1,s=0;s<=a;){var c=Math.floor((s+a)/2);o[c].timestamp<=i.timestamp?s=c+1:a=c-1}-1===t&&(t=s),o.splice(t,0,i)}var t=i.timestamp<n,l=v(i,t);t?l():r.isActive()&&r.addAction({doAction:function(){l(),g.emit(w.EventCast,i)},delay:i.delay})}return ie(ie({},e),{events:o})})}}))}var b;function S(e,t){e=e[t[0]];return 1===t.length?e:S(e.cssRules[t[1]].cssRules,t.slice(2))}function $o(e){var e=se(e),t=e.pop();return{positions:e,index:t}}function Qo(e,d){var p=d.sheet;p&&e.forEach(function(e){if(e.type===b.Insert)try{var t;Array.isArray(e.index)?(r=(t=$o(e.index)).positions,o=t.index,S(p.cssRules,r).insertRule(e.cssText,o)):p.insertRule(e.cssText,e.index)}catch(e){}else if(e.type===b.Remove)try{var n,r,o;Array.isArray(e.index)?(r=(n=$o(e.index)).positions,o=n.index,S(p.cssRules,r).deleteRule(o||0)):p.deleteRule(e.index)}catch(e){}else if(e.type===b.Snapshot){var i,a=e.cssTexts,s=d;try{var c=Array.from((null==(i=s.sheet)?void 0:i.cssRules)||[]).map(function(e){return e.cssText}),l=Object.entries(c).reverse(),u=c.length;l.forEach(function(e){var t,e=cr(e,2),n=e[0],e=e[1],e=a.indexOf(e);if(-1===e||u<e)try{null!=(t=s.sheet)&&t.deleteRule(Number(n))}catch(e){}u=e}),a.forEach(function(e,t){var n,r,o;try{(null==(r=null==(n=s.sheet)?void 0:n.cssRules[t])?void 0:r.cssText)!==e&&null!=(o=s.sheet)&&o.insertRule(e,t)}catch(e){}})}catch(e){}}else e.type===b.SetProperty?S(p.cssRules,e.index).style.setProperty(e.property,e.value,e.priority):e.type===b.RemoveProperty&&S(p.cssRules,e.index).style.removeProperty(e.property)})}(n=b=b||{})[n.Insert=0]="Insert",n[n.Remove=1]="Remove",n[n.Snapshot=2]="Snapshot",n[n.SetProperty=3]="SetProperty",n[n.RemoveProperty=4]="RemoveProperty";var Ko=Mo,Zo="[replayer]",ei={duration:500,lineCap:"round",lineWidth:3,strokeStyle:"red"};function ti(e){return e.type==F.IncrementalSnapshot&&(e.data.source==ce.TouchMove||e.data.source==ce.MouseInteraction&&e.data.type==g.TouchStart)}Object.defineProperty(p.prototype,"timer",{get:function(){return this.service.state.context.timer},enumerable:!1,configurable:!0}),p.prototype.on=function(e,t){return this.emitter.on(e,t),this},p.prototype.off=function(e,t){return this.emitter.off(e,t),this},p.prototype.setConfig=function(t){var n=this;Object.keys(t).forEach(function(e){n.config[e]=t[e]}),this.config.skipInactive||this.backToNormal(),void 0!==t.speed&&this.speedService.send({type:"SET_SPEED",payload:{speed:t.speed}}),void 0!==t.mouseTail&&(!1===t.mouseTail?this.mouseTail&&(this.mouseTail.style.display="none"):(this.mouseTail||(this.mouseTail=document.createElement("canvas"),this.mouseTail.width=Number.parseFloat(this.iframe.width),this.mouseTail.height=Number.parseFloat(this.iframe.height),this.mouseTail.classList.add("replayer-mouse-tail"),this.wrapper.insertBefore(this.mouseTail,this.iframe)),this.mouseTail.style.display="inherit"))},p.prototype.getMetaData=function(){var e=this.service.state.context.events[0],t=this.service.state.context.events[this.service.state.context.events.length-1];return{startTime:e.timestamp,endTime:t.timestamp,totalTime:t.timestamp-e.timestamp}},p.prototype.getCurrentTime=function(){return this.timer.timeOffset+this.getTimeOffset()},p.prototype.getTimeOffset=function(){var e=this.service.state.context;return e.baselineTime-e.events[0].timestamp},p.prototype.getMirror=function(){return this.mirror},p.prototype.play=function(e){void 0===e&&(e=0),this.service.state.matches("paused")||this.service.send({type:"PAUSE"}),this.service.send({type:"PLAY",payload:{timeOffset:e}}),null!=(e=this.iframe.contentDocument)&&e.getElementsByTagName("html")[0].classList.remove("rrweb-paused"),this.emitter.emit(w.Start)},p.prototype.pause=function(e){void 0===e&&this.service.state.matches("playing")&&this.service.send({type:"PAUSE"}),"number"==typeof e&&(this.play(e),this.service.send({type:"PAUSE"})),null!=(e=this.iframe.contentDocument)&&e.getElementsByTagName("html")[0].classList.add("rrweb-paused"),this.emitter.emit(w.Pause)},p.prototype.resume=function(e){void 0===e&&(e=0),console.warn("The 'resume' will be departed in 1.0. Please use 'play' method which has the same interface."),this.play(e),this.emitter.emit(w.Resume)},p.prototype.startLive=function(e){this.service.send({type:"TO_LIVE",payload:{baselineTime:e}})},p.prototype.addEvent=function(e){var t=this,n=this.config.unpackFn?this.config.unpackFn(e):e;ti(n)&&this.mouse.classList.add("touch-device"),Promise.resolve().then(function(){return t.service.send({type:"ADD_EVENT",payload:{event:n}})})},p.prototype.enableInteract=function(){this.iframe.setAttribute("scrolling","auto"),this.iframe.style.pointerEvents="auto"},p.prototype.disableInteract=function(){this.iframe.setAttribute("scrolling","no"),this.iframe.style.pointerEvents="none"},p.prototype.resetCache=function(){this.cache=Lr()},p.prototype.setupDom=function(){this.wrapper=document.createElement("div"),this.wrapper.classList.add("replayer-wrapper"),this.config.root.appendChild(this.wrapper),this.mouse=document.createElement("div"),this.mouse.classList.add("replayer-mouse"),this.wrapper.appendChild(this.mouse),!1!==this.config.mouseTail&&(this.mouseTail=document.createElement("canvas"),this.mouseTail.classList.add("replayer-mouse-tail"),this.mouseTail.style.display="inherit",this.wrapper.appendChild(this.mouseTail)),this.iframe=document.createElement("iframe");var e=["allow-same-origin"];this.config.UNSAFE_replayCanvas&&e.push("allow-scripts"),this.iframe.style.display="none",this.iframe.setAttribute("sandbox",e.join(" ")),this.disableInteract(),this.wrapper.appendChild(this.iframe),this.iframe.contentWindow&&this.iframe.contentDocument&&(Do(this.iframe.contentWindow,this.iframe.contentDocument),Yr(this.iframe.contentWindow))},p.prototype.handleResize=function(e){var t,n;this.iframe.style.display="inherit";try{for(var r=ae([this.mouseTail,this.iframe]),o=r.next();!o.done;o=r.next()){var i=o.value;i&&(i.setAttribute("width",String(e.width)),i.setAttribute("height",String(e.height)))}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}},p.prototype.applyEventsSynchronously=function(e){var t,n;try{for(var r=ae(e),o=r.next();!o.done;o=r.next()){var i=o.value;switch(i.type){case F.DomContentLoaded:case F.Load:case F.Custom:continue;case F.FullSnapshot:case F.Meta:case F.Plugin:break;case F.IncrementalSnapshot:if(i.data.source===ce.MediaInteraction)continue}this.getCastFn(i,!0)()}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}this.mousePos&&this.moveAndHover(this.mousePos.x,this.mousePos.y,this.mousePos.id,!0,this.mousePos.debugData),!(this.mousePos=null)===this.touchActive?this.mouse.classList.add("touch-active"):!1===this.touchActive&&this.mouse.classList.remove("touch-active"),this.touchActive=null},p.prototype.getCastFn=function(a,s){var c,l=this;switch(void 0===s&&(s=!1),a.type){case F.DomContentLoaded:case F.Load:break;case F.Custom:c=function(){l.emitter.emit(w.CustomEvent,a)};break;case F.Meta:c=function(){return l.emitter.emit(w.Resize,{width:a.data.width,height:a.data.height})};break;case F.FullSnapshot:c=function(){if(l.firstFullSnapshot){if(l.firstFullSnapshot===a)return void(l.firstFullSnapshot=!0)}else l.firstFullSnapshot=!0;l.rebuildFullSnapshot(a,s),l.iframe.contentWindow.scrollTo(a.data.initialOffset)};break;case F.IncrementalSnapshot:c=function(){var e,t;if(l.applyIncremental(a,s),!s&&(a===l.nextUserInteractionEvent&&(l.nextUserInteractionEvent=null,l.backToNormal()),l.config.skipInactive&&!l.nextUserInteractionEvent)){try{for(var n=ae(l.service.state.context.events),r=n.next();!r.done;r=n.next()){var o=r.value;if(!(o.timestamp<=a.timestamp)&&l.isUserInteraction(o)){o.delay-a.delay>1e4*l.speedService.state.context.timer.speed&&(l.nextUserInteractionEvent=o);break}}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}l.nextUserInteractionEvent&&(e=l.nextUserInteractionEvent.delay-a.delay,t={speed:Math.min(Math.round(e/5e3),l.config.maxSpeed)},l.speedService.send({type:"FAST_FORWARD",payload:t}),l.emitter.emit(w.SkipStart,t))}}}return function(){var t,e;c&&c();try{for(var n=ae(l.config.plugins||[]),r=n.next();!r.done;r=n.next())r.value.handler(a,s,{replayer:l})}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}l.service.send({type:"CAST_EVENT",payload:{event:a}});var o,i=l.service.state.context.events.length-1;a===l.service.state.context.events[i]&&(o=function(){i<l.service.state.context.events.length-1||(l.backToNormal(),l.service.send("END"),l.emitter.emit(w.Finish))},a.type===F.IncrementalSnapshot&&a.data.source===ce.MouseMove&&a.data.positions.length?setTimeout(function(){o()},Math.max(0,50-a.data.positions[0].timeOffset)):o())}},p.prototype.rebuildFullSnapshot=function(e,t){var n=this;if(void 0===t&&(t=!1),!this.iframe.contentDocument)return console.warn("Looks like your replayer has been destroyed.");Object.keys(this.legacy_missingNodeRetryMap).length&&console.warn("Found unresolved missing node map",this.legacy_missingNodeRetryMap),this.legacy_missingNodeRetryMap={};var r=[],o=(this.mirror.map=Hr(e.data.node,{doc:this.iframe.contentDocument,afterAppend:function(e){n.collectIframeAndAttachDocument(r,e)},cache:this.cache})[1],this);try{for(var i=ae(r),a=i.next();!a.done;a=i.next()){var s=a.value;!function(t,e){var n;o.attachDocumentToIframe(t,e),o.newDocumentQueue=o.newDocumentQueue.filter(function(e){return e!==t}),e.contentDocument&&(n=(e=e.contentDocument).documentElement,e=e.head,o.insertStyleRules(n,e))}(s.mutationInQueue,s.builtNode)}}catch(e){l={error:e}}finally{try{a&&!a.done&&(c=i.return)&&c.call(i)}finally{if(l)throw l.error}}var c=this.iframe.contentDocument,l=c.documentElement,c=c.head;this.insertStyleRules(l,c),this.service.state.matches("playing")||this.iframe.contentDocument.getElementsByTagName("html")[0].classList.add("rrweb-paused"),this.emitter.emit(w.FullsnapshotRebuilded,e),t||this.waitForStylesheetLoad(),this.config.UNSAFE_replayCanvas&&this.preloadAllImages()},p.prototype.insertStyleRules=function(e,t){var n=document.createElement("style"),r=(e.insertBefore(n,t),["."+this.config.blockClass+" { background: currentColor }","noscript { display: none !important; }"].concat(this.config.insertStyleRules));this.config.pauseAnimation&&r.push("html.rrweb-paused *, html.rrweb-paused *:before, html.rrweb-paused *:after { animation-play-state: paused !important; }");for(var o=0;o<r.length;o++)n.sheet.insertRule(r[o],o)},p.prototype.attachDocumentToIframe=function(e,t){var n,r,o=this,i=[];if(!t.contentDocument)for(var a=t.parentNode;a;){if(this.fragmentParentMap.has(a)){var s=a,c=this.fragmentParentMap.get(s);this.restoreRealParent(s,c);break}a=a.parentNode}Pr(e.node,{doc:t.contentDocument,map:this.mirror.map,hackCss:!0,skipChild:!1,afterAppend:function(e){o.collectIframeAndAttachDocument(i,e)},cache:this.cache});var l=this;try{for(var u=ae(i),d=u.next();!d.done;d=u.next()){var p=d.value;!function(t,e){var n;l.attachDocumentToIframe(t,e),l.newDocumentQueue=l.newDocumentQueue.filter(function(e){return e!==t}),e.contentDocument&&(n=(e=e.contentDocument).documentElement,e=e.head,l.insertStyleRules(n,e))}(p.mutationInQueue,p.builtNode)}}catch(e){n={error:e}}finally{try{d&&!d.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}},p.prototype.collectIframeAndAttachDocument=function(e,t){var n;Kr(t)&&(n=this.newDocumentQueue.find(function(e){return e.parentId===t.__sn.id}))&&e.push({mutationInQueue:n,builtNode:t})},p.prototype.waitForStylesheetLoad=function(){var t,n,r,e,o,i=this,a=null==(a=this.iframe.contentDocument)?void 0:a.head;a&&(t=new Set,r=this.service.state,e=function(){r=i.service.state},this.emitter.on(w.Start,e),this.emitter.on(w.Pause,e),o=function(){i.emitter.off(w.Start,e),i.emitter.off(w.Pause,e)},a.querySelectorAll('link[rel="stylesheet"]').forEach(function(e){e.sheet||(t.add(e),e.addEventListener("load",function(){t.delete(e),0===t.size&&-1!==n&&(r.matches("playing")&&i.play(i.getCurrentTime()),i.emitter.emit(w.LoadStylesheetEnd),n&&clearTimeout(n),o())}))}),0<t.size&&(this.service.send({type:"PAUSE"}),this.emitter.emit(w.LoadStylesheetStart),n=setTimeout(function(){r.matches("playing")&&i.play(i.getCurrentTime()),n=-1,o()},this.config.loadTimeout)))},p.prototype.preloadAllImages=function(){function e(){r.service.state}var t,n,r=this;this.service.state;this.emitter.on(w.Start,e),this.emitter.on(w.Pause,e);try{for(var o=ae(this.service.state.context.events),i=o.next();!i.done;i=o.next()){var a,s,c,l=i.value;l.type!==F.IncrementalSnapshot||l.data.source!==ce.CanvasMutation||"drawImage"!==l.data.property||"string"!=typeof l.data.args[0]||this.imageMap.has(l)||(null==(c=null==(s=(a=document.createElement("canvas")).getContext("2d"))?void 0:s.createImageData(a.width,a.height))||c.data,JSON.parse(l.data.args[0]),null!=s&&s.putImageData(c,0,0))}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}},p.prototype.applyIncremental=function(n,r){var e,o=this,i=n.data;switch(i.source){case ce.Mutation:r&&(i.adds.forEach(function(e){return o.treeIndex.add(e)}),i.texts.forEach(function(e){return o.treeIndex.text(e)}),i.attributes.forEach(function(e){return o.treeIndex.attribute(e)}),i.removes.forEach(function(e){return o.treeIndex.remove(e,o.mirror)}));try{this.applyMutation(i,r)}catch(e){this.warn("Exception in mutation "+(e.message||e),i)}break;case ce.Drag:case ce.TouchMove:case ce.MouseMove:r?(c=i.positions[i.positions.length-1],this.mousePos={x:c.x,y:c.y,id:c.id,debugData:i}):(i.positions.forEach(function(e){var t={doAction:function(){o.moveAndHover(e.x,e.y,e.id,r,i)},delay:e.timeOffset+n.timestamp-o.service.state.context.baselineTime};o.timer.addAction(t)}),this.timer.addAction({doAction:function(){},delay:n.delay-(null==(c=i.positions[0])?void 0:c.timeOffset)}));break;case ce.MouseInteraction:if(-1===i.id)break;var t,a=new Event(g[i.type].toLowerCase());if(!(t=this.mirror.getNode(i.id)))return this.debugNodeNotFound(i,i.id);this.emitter.emit(w.MouseInteraction,{type:i.type,target:t});var s=this.config.triggerFocus;switch(i.type){case g.Blur:"blur"in t&&t.blur();break;case g.Focus:s&&t.focus&&t.focus({preventScroll:!0});break;case g.Click:case g.TouchStart:case g.TouchEnd:r?(i.type===g.TouchStart?this.touchActive=!0:i.type===g.TouchEnd&&(this.touchActive=!1),this.mousePos={x:i.x,y:i.y,id:i.id,debugData:i}):(i.type===g.TouchStart&&(this.tailPositions.length=0),this.moveAndHover(i.x,i.y,i.id,r,i),i.type===g.Click?(this.mouse.classList.remove("active"),this.mouse.offsetWidth,this.mouse.classList.add("active")):i.type===g.TouchStart?(this.mouse.offsetWidth,this.mouse.classList.add("touch-active")):i.type===g.TouchEnd&&this.mouse.classList.remove("touch-active"));break;case g.TouchCancel:r?this.touchActive=!1:this.mouse.classList.remove("touch-active");break;default:t.dispatchEvent(a)}break;case ce.Scroll:if(-1===i.id)break;if(r){this.treeIndex.scroll(i);break}this.applyScroll(i);break;case ce.ViewportResize:this.emitter.emit(w.Resize,{width:i.width,height:i.height});break;case ce.Input:if(-1===i.id)break;if(r){this.treeIndex.input(i);break}this.applyInput(i);break;case ce.MediaInteraction:if(!(t=this.mirror.getNode(i.id)))return this.debugNodeNotFound(i,i.id);var c=t;try{i.currentTime&&(c.currentTime=i.currentTime),1===i.type&&c.pause(),0===i.type&&c.play()}catch(e){this.config.showWarning&&console.warn("Failed to replay media interactions: "+(e.message||e))}break;case ce.StyleSheetRule:if(!(t=this.mirror.getNode(i.id)))return this.debugNodeNotFound(i,i.id);var l,u=t,c=t.parentNode,d=this.fragmentParentMap.has(c),p=d?null:u.sheet;p||(this.virtualStyleRulesMap.has(t)?l=this.virtualStyleRulesMap.get(t):(l=[],this.virtualStyleRulesMap.set(t,l))),i.adds&&i.adds.forEach(function(e){var t,n,r,o=e.rule,e=e.index;if(p)try{Array.isArray(e)?(n=(t=$o(e)).positions,r=t.index,S(p.cssRules,n).insertRule(o,r)):(r=void 0===e?void 0:Math.min(e,p.cssRules.length),p.insertRule(o,r))}catch(e){}else null!=l&&l.push({cssText:o,index:e,type:b.Insert})}),i.removes&&i.removes.forEach(function(e){var t,n,r,e=e.index;if(d)null!=l&&l.push({index:e,type:b.Remove});else try{Array.isArray(e)?(n=(t=$o(e)).positions,r=t.index,S(p.cssRules,n).deleteRule(r||0)):null!=p&&p.deleteRule(e)}catch(e){}});break;case ce.StyleDeclaration:if(!(t=this.mirror.getNode(i.id)))return this.debugNodeNotFound(i,i.id);u=t,c=t.parentNode,c=this.fragmentParentMap.has(c)?null:u.sheet,u=[];c||(this.virtualStyleRulesMap.has(t)?u=this.virtualStyleRulesMap.get(t):this.virtualStyleRulesMap.set(t,u=[])),i.set&&(c?S(c.rules,i.index).style.setProperty(i.set.property,i.set.value,i.set.priority):u.push(ie({type:b.SetProperty,index:i.index},i.set))),i.remove&&(c?S(c.rules,i.index).style.removeProperty(i.remove.property):u.push(ie({type:b.RemoveProperty,index:i.index},i.remove)));break;case ce.CanvasMutation:if(!this.config.UNSAFE_replayCanvas)return;if(!(t=this.mirror.getNode(i.id)))return this.debugNodeNotFound(i,i.id);try{var f=t.getContext("2d");if(i.setter)return void(f[i.property]=i.args[0]);var h,m=f[i.property];"drawImage"===i.property&&"string"==typeof i.args[0]&&(h=this.imageMap.get(n),i.args[0]=h),m.apply(f,i.args)}catch(e){this.warnCanvasMutationFailed(i,i.id,e)}break;case ce.Font:try{var v=new FontFace(i.family,i.buffer?new Uint8Array(JSON.parse(i.fontSource)):i.fontSource,i.descriptors);null!=(e=this.iframe.contentDocument)&&e.fonts.add(v)}catch(e){this.config.showWarning&&console.warn(e)}}},p.prototype.applyMutation=function(c,h){for(var t,e,m=this,v=(c.removes.forEach(function(t){var n=m.mirror.getNode(t.id);if(!n)return c.removes.find(function(e){return e.id===t.parentId})?void 0:m.warnNodeNotFound(c,t.id);m.virtualStyleRulesMap.has(n)&&m.virtualStyleRulesMap.delete(n);var r=m.mirror.getNode(t.parentId);if(!r)return m.warnNodeNotFound(c,t.parentId);if(t.isShadow&&Zr(r)&&(r=r.shadowRoot),m.mirror.removeNodeFromMap(n),r){var o=null,i="__sn"in r?m.fragmentParentMap.get(r):void 0;i&&i.contains(n)?r=i:m.fragmentParentMap.has(n)&&(o=m.fragmentParentMap.get(n),m.fragmentParentMap.delete(n),n=o);try{r.removeChild(n)}catch(e){if(!(e instanceof DOMException))throw e;m.warn("parent could not remove child in mutation",r,i,n,o,c)}}}),ie({},this.legacy_missingNodeRetryMap)),y=[],g=function(e){var t=null;return e.nextId&&(t=m.mirror.getNode(e.nextId)),null!==e.nextId&&void 0!==e.nextId&&-1!==e.nextId&&!t},n=function(e){if(!m.iframe.contentDocument)return console.warn("Looks like your replayer has been destroyed.");var t=m.mirror.getNode(e.parentId);if(!t)return(e.node.type===I.Document?m.newDocumentQueue:y).push(e);var n=null,r=(m.iframe.contentDocument.contains?n=m.iframe.contentDocument.contains(t):m.iframe.contentDocument.body.contains&&(n=m.iframe.contentDocument.body.contains(t)),0<(null==(r=(i=t).getElementsByTagName)?void 0:r.call(i,"iframe").length));if(h&&n&&!Kr(t)&&!r){var o=document.createDocumentFragment();for(m.mirror.map[e.parentId]=o,m.fragmentParentMap.set(o,t),m.storeState(t);t.firstChild;)o.appendChild(t.firstChild);t=o}e.node.isShadow&&Zr(t)&&(t=t.shadowRoot);var i=null,n=null;if(e.previousId&&(i=m.mirror.getNode(e.previousId)),e.nextId&&(n=m.mirror.getNode(e.nextId)),g(e))return y.push(e);if(!e.node.rootId||m.mirror.getNode(e.node.rootId)){var a=e.node.rootId?m.mirror.getNode(e.node.rootId):m.iframe.contentDocument;if(Kr(t))m.attachDocumentToIframe(e,t);else{var s,c,l,u=Pr(e.node,{doc:a,map:m.mirror.map,skipChild:!0,hackCss:!0,cache:m.cache});if(-1===e.previousId||-1===e.nextId)v[e.node.id]={node:u,mutation:e};else{if("__sn"in t&&t.__sn.type===I.Element&&"textarea"===t.__sn.tagName&&e.node.type===I.Text)try{for(var d=ae(Array.from(t.childNodes)),p=d.next();!p.done;p=d.next()){var f=p.value;f.nodeType===t.TEXT_NODE&&t.removeChild(f)}}catch(e){l={error:e}}finally{try{p&&!p.done&&(c=d.return)&&c.call(d)}finally{if(l)throw l.error}}if(i&&i.nextSibling&&i.nextSibling.parentNode)t.insertBefore(u,i.nextSibling);else if(n&&n.parentNode)t.contains(n)?t.insertBefore(u,n):t.insertBefore(u,null);else{if(t===a)for(;a.firstChild;)a.removeChild(a.firstChild);t.appendChild(u)}Kr(u)&&((s=m.newDocumentQueue.find(function(e){return e.parentId===u.__sn.id}))&&(m.attachDocumentToIframe(s,u),m.newDocumentQueue=m.newDocumentQueue.filter(function(e){return e!==s})),u.contentDocument&&(c=(r=u.contentDocument).documentElement,l=r.head,m.insertStyleRules(c,l))),(e.previousId||e.nextId)&&m.legacy_resolveMissingNode(v,t,u,e)}}}},r=(c.adds.forEach(function(e){n(e)}),Date.now());y.length;){var o=Qr(y);if(y.length=0,500<Date.now()-r){this.warn("Timeout in the loop, please check the resolve tree data:",o);break}try{t=void 0;for(var i=ae(o),a=i.next();!a.done;a=i.next()){var s=a.value;this.mirror.getNode(s.value.parentId)?function e(t,n){n(t.value);for(var r=t.children.length-1;0<=r;r--)e(t.children[r],n)}(s,function(e){n(e)}):this.debug("Drop resolve tree since there is no parent for the root node.",s)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}}Object.keys(v).length&&Object.assign(this.legacy_missingNodeRetryMap,v),c.texts.forEach(function(t){var e=m.mirror.getNode(t.id);if(!e)return c.removes.find(function(e){return e.id===t.id})?void 0:m.warnNodeNotFound(c,t.id);(e=m.fragmentParentMap.has(e)?m.fragmentParentMap.get(e):e).textContent=t.value}),c.attributes.forEach(function(t){var e,n=m.mirror.getNode(t.id);if(!n)return c.removes.find(function(e){return e.id===t.id})?void 0:m.warnNodeNotFound(c,t.id);for(e in m.fragmentParentMap.has(n)&&(n=m.fragmentParentMap.get(n)),t.attributes)if("string"==typeof e){var r=t.attributes[e];if(null===r)n.removeAttribute(e);else if("string"==typeof r)try{n.setAttribute(e,r)}catch(e){m.config.showWarning&&console.warn("An error occurred may due to the checkout feature.",e)}else if("style"===e){var o,i,a=r,s=n;for(o in a)!1===a[o]?s.style.removeProperty(o):a[o]instanceof Array?(i=a[o],s.style.setProperty(o,i[0],i[1])):(i=a[o],s.style.setProperty(o,i))}}})},p.prototype.applyScroll=function(e){var t=this.mirror.getNode(e.id);if(!t)return this.debugNodeNotFound(e,e.id);if(t===this.iframe.contentDocument)this.iframe.contentWindow.scrollTo({top:e.y,left:e.x,behavior:"smooth"});else if(t.__sn.type===I.Document)t.defaultView.scrollTo({top:e.y,left:e.x,behavior:"smooth"});else try{t.scrollTop=e.y,t.scrollLeft=e.x}catch(e){}},p.prototype.applyInput=function(e){var t=this.mirror.getNode(e.id);if(!t)return this.debugNodeNotFound(e,e.id);try{t.checked=e.isChecked,t.value=e.text}catch(e){}},p.prototype.legacy_resolveMissingNode=function(e,t,n,r){var o,i,a=r.previousId,r=r.nextId,a=a&&e[a],r=r&&e[r];a&&(o=a.node,i=a.mutation,t.insertBefore(o,n),delete e[i.node.id],delete this.legacy_missingNodeRetryMap[i.node.id],(i.previousId||i.nextId)&&this.legacy_resolveMissingNode(e,t,o,i)),r&&(o=r.node,i=r.mutation,t.insertBefore(o,n.nextSibling),delete e[i.node.id],delete this.legacy_missingNodeRetryMap[i.node.id],(i.previousId||i.nextId)&&this.legacy_resolveMissingNode(e,t,o,i))},p.prototype.moveAndHover=function(e,t,n,r,o){var i=this.mirror.getNode(n);if(!i)return this.debugNodeNotFound(o,n);o=function e(t,n){t=null==(t=null==(t=t.ownerDocument)?void 0:t.defaultView)?void 0:t.frameElement;if(!t||t===n)return{x:0,y:0,relativeScale:1,absoluteScale:1};var r=t.getBoundingClientRect(),n=e(t,n),t=r.height/t.clientHeight;return{x:r.x*n.relativeScale+n.x,y:r.y*n.relativeScale+n.y,relativeScale:t,absoluteScale:n.absoluteScale*t}}(i,this.iframe),n=e*o.absoluteScale+o.x,e=t*o.absoluteScale+o.y;this.mouse.style.left=n+"px",this.mouse.style.top=e+"px",r||this.drawMouseTail({x:n,y:e}),this.hoverElements(i)},p.prototype.drawMouseTail=function(t){var e,n,r,o,i,a=this;this.mouseTail&&(o=!0===this.config.mouseTail?ei:Object.assign({},ei,this.config.mouseTail),e=o.lineCap,n=o.lineWidth,r=o.strokeStyle,o=o.duration,i=function(){var t;!a.mouseTail||(t=a.mouseTail.getContext("2d"))&&a.tailPositions.length&&(t.clearRect(0,0,a.mouseTail.width,a.mouseTail.height),t.beginPath(),t.lineWidth=n,t.lineCap=e,t.strokeStyle=r,t.moveTo(a.tailPositions[0].x,a.tailPositions[0].y),a.tailPositions.forEach(function(e){return t.lineTo(e.x,e.y)}),t.stroke())},this.tailPositions.push(t),i(),setTimeout(function(){a.tailPositions=a.tailPositions.filter(function(e){return e!==t}),i()},o/this.speedService.state.context.timer.speed))},p.prototype.hoverElements=function(e){null!=(t=this.iframe.contentDocument)&&t.querySelectorAll(".\\:hover").forEach(function(e){e.classList.remove(":hover")});for(var t,n=e;n;)n.classList&&n.classList.add(":hover"),n=n.parentElement},p.prototype.isUserInteraction=function(e){return e.type===F.IncrementalSnapshot&&(e.data.source>ce.Mutation&&e.data.source<=ce.Input)},p.prototype.backToNormal=function(){this.nextUserInteractionEvent=null,this.speedService.state.matches("normal")||(this.speedService.send({type:"BACK_TO_NORMAL"}),this.emitter.emit(w.SkipEnd,{speed:this.speedService.state.context.normalSpeed}))},p.prototype.restoreRealParent=function(e,t){(this.mirror.map[t.__sn.id]=t).__sn.type===I.Element&&"textarea"===t.__sn.tagName&&e.textContent&&(t.value=e.textContent),t.appendChild(e),this.restoreState(t)},p.prototype.storeState=function(e){var t,n;if(e&&e.nodeType===e.ELEMENT_NODE){var r=e;if((r.scrollLeft||r.scrollTop)&&this.elementStateMap.set(e,{scroll:[r.scrollLeft,r.scrollTop]}),"STYLE"===r.tagName){var e=r,o=this.virtualStyleRulesMap;try{var i=Array.from((null==(a=e.sheet)?void 0:a.cssRules)||[]).map(function(e){return e.cssText});o.set(e,[{type:b.Snapshot,cssTexts:i}])}catch(e){}}var a=r.children;try{for(var s=ae(Array.from(a)),c=s.next();!c.done;c=s.next()){var l=c.value;this.storeState(l)}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}}},p.prototype.restoreState=function(e){var t,n;if(e.nodeType===e.ELEMENT_NODE){var r=e,o=(this.elementStateMap.has(e)&&((o=this.elementStateMap.get(e)).scroll&&(r.scrollLeft=o.scroll[0],r.scrollTop=o.scroll[1]),this.elementStateMap.delete(e)),r.children);try{for(var i=ae(Array.from(o)),a=i.next();!a.done;a=i.next()){var s=a.value;this.restoreState(s)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}}},p.prototype.restoreNodeSheet=function(e){var t=this.virtualStyleRulesMap.get(e);"STYLE"===e.nodeName&&t&&Qo(t,e)},p.prototype.warnNodeNotFound=function(e,t){this.treeIndex.idRemoved(t)?this.warn("Node with id '"+t+"' was previously removed. ",e):this.warn("Node with id '"+t+"' not found. ",e)},p.prototype.warnCanvasMutationFailed=function(e,t,n){this.warn("Has error on update canvas '"+t+"'",e,n)},p.prototype.debugNodeNotFound=function(e,t){this.treeIndex.idRemoved(t)?this.debug(Zo,"Node with id '"+t+"' was previously removed. ",e):this.debug(Zo,"Node with id '"+t+"' not found. ",e)},p.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.config.showWarning&&console.warn.apply(console,se([Zo],e))},p.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.config.showDebug&&console.log.apply(console,se([Zo],e))};function p(e,t){var v=this;if(this.mouseTail=null,this.tailPositions=[],this.emitter=Ko(),this.legacy_missingNodeRetryMap={},this.cache=Lr(),this.imageMap=new Map,this.mirror=Ur(),this.firstFullSnapshot=null,this.newDocumentQueue=[],this.mousePos=null,((this.touchActive=null)==t||!t.liveMode)&&e.length<2)throw new Error("Replayer need at least 2 events.");var n,r,o={speed:1,maxSpeed:360,root:document.body,loadTimeout:0,skipInactive:!1,showWarning:!0,showDebug:!1,blockClass:"rr-block",liveMode:!1,insertStyleRules:[],triggerFocus:!0,UNSAFE_replayCanvas:!1,pauseAnimation:!0,mouseTail:ei},o=(this.config=Object.assign({},o,t),this.handleResize=this.handleResize.bind(this),this.getCastFn=this.getCastFn.bind(this),this.applyEventsSynchronously=this.applyEventsSynchronously.bind(this),this.emitter.on(w.Resize,this.handleResize),this.setupDom(),this.treeIndex=new $r,this.fragmentParentMap=new Map,this.elementStateMap=new Map,this.virtualStyleRulesMap=new Map,this.emitter.on(w.Flush,function(){var t,e,n,r,o,i,a=v.treeIndex.flush(),s=a.scrollMap,a=a.inputMap;v.fragmentParentMap.forEach(function(e,t){return v.restoreRealParent(t,e)});try{for(var c=ae(v.virtualStyleRulesMap.keys()),l=c.next();!l.done;l=c.next()){var u=l.value;v.restoreNodeSheet(u)}}catch(e){t={error:e}}finally{try{l&&!l.done&&(e=c.return)&&e.call(c)}finally{if(t)throw t.error}}v.fragmentParentMap.clear(),v.elementStateMap.clear(),v.virtualStyleRulesMap.clear();try{for(var d=ae(s.values()),p=d.next();!p.done;p=d.next()){var f=p.value;v.applyScroll(f)}}catch(e){n={error:e}}finally{try{p&&!p.done&&(r=d.return)&&r.call(d)}finally{if(n)throw n.error}}try{for(var h=ae(a.values()),m=h.next();!m.done;m=h.next()){f=m.value;v.applyInput(f)}}catch(e){o={error:e}}finally{try{m&&!m.done&&(i=h.return)&&i.call(h)}finally{if(o)throw o.error}}}),this.emitter.on(w.PlayBack,function(){v.firstFullSnapshot=null,v.mirror.reset()}),new Lo([],(null==t?void 0:t.speed)||o.speed)),e=(this.service=Yo({events:e.map(function(e){return t&&t.unpackFn?t.unpackFn(e):e}).sort(function(e,t){return e.timestamp-t.timestamp}),timer:o,timeOffset:0,baselineTime:0,lastPlayedEvent:null},{getCastFn:this.getCastFn,applyEventsSynchronously:this.applyEventsSynchronously,emitter:this.emitter}),this.service.start(),this.service.subscribe(function(e){v.emitter.emit(w.StateChange,{player:e})}),this.speedService=Jo(qo({id:"speed",context:{normalSpeed:-1,timer:o},initial:"normal",states:{normal:{on:{FAST_FORWARD:{target:"skipping",actions:["recordSpeed","setSpeed"]},SET_SPEED:{target:"normal",actions:["setSpeed"]}}},skipping:{on:{BACK_TO_NORMAL:{target:"normal",actions:["restoreSpeed"]},SET_SPEED:{target:"normal",actions:["setSpeed"]}}}}},{actions:{setSpeed:function(e,t){"payload"in t&&e.timer.setSpeed(t.payload.speed)},recordSpeed:Uo({normalSpeed:function(e){return e.timer.speed}}),restoreSpeed:function(e){e.timer.setSpeed(e.normalSpeed)}}})),this.speedService.start(),this.speedService.subscribe(function(e){v.emitter.emit(w.StateChange,{speed:e})}),this.service.state.context.events.find(function(e){return e.type===F.Meta})),i=this.service.state.context.events.find(function(e){return e.type===F.FullSnapshot});e&&(o=e.data,n=o.width,r=o.height,setTimeout(function(){v.emitter.emit(w.Resize,{width:n,height:r})},0)),i&&setTimeout(function(){v.firstFullSnapshot||(v.firstFullSnapshot=i,v.rebuildFullSnapshot(i),v.iframe.contentWindow.scrollTo(i.data.initialOffset))},1),this.service.state.context.events.find(ti)&&this.mouse.classList.add("touch-device")}for(var r=Uint8Array,ni=Uint16Array,ri=Uint32Array,o=new r([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),e=new r([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),n=function(e,t){for(var n=new ni(31),r=0;r<31;++r)n[r]=t+=1<<e[r-1];for(var o=new ri(n[30]),r=1;r<30;++r)for(var i=n[r];i<n[r+1];++i)o[i]=i-n[r]<<5|r;return[n,o]},o=n(o,2),oi=o[0],ii=(o[1][oi[28]=258]=28,n(e,0),new ni(32768)),_=0;_<32768;++_){var ai=(43690&_)>>>1|(21845&_)<<1;ii[_]=((65280&(ai=(61680&(ai=(52428&ai)>>>2|(13107&ai)<<2))>>>4|(3855&ai)<<4))>>>8|(255&ai)<<8)>>>1}for(var si=new r(288),_=0;_<144;++_)si[_]=8;for(_=144;_<256;++_)si[_]=9;for(_=256;_<280;++_)si[_]=7;for(_=280;_<288;++_)si[_]=8;for(var ci=new r(32),_=0;_<32;++_)ci[_]=5;ui.prototype.install=function(n){try{No({emit:function(e,t){t&&n.eventsMatrix.push([]),n.eventsMatrix[n.eventsMatrix.length-1].push(e)},checkoutEveryNms:5e3})}catch(e){console.log("video功能不兼容")}};var li=ui;function ui(){}var di=[],pi={DO_NOT_USE:"",ECMASCRIPT_ERROR:"ecmaScriptError",XHR_ERROR:"xhrError",RESOURCE_ERROR:"resourceError",FETCH_ERROR:"fetchError",JSONP_ERROR:"jsonpError",UNHANDLEDREJECTION:"unhandledRejection",LOW_FPS:"lowFps",PAGE_CRASH:"pageCrash",SLOW_INTERFACE_RESPONSE:"slowInterResp",CUSTOM:"custom"},fi=null,hi=(x.prototype.filterBreadcrumbs=function(e){e.reverse();for(var t=0,n=e;t<n.length;t++){var r=n[t];if(("XHR"===r.category||"FETCH"===r.category)&&r.data.responseText&&0<r.data.code){r.isLastXHR=!0;break}}return e.reverse(),e.forEach(function(e){e.isLastXHR?e.data.responseText||(e.data.responseText=null):e.data.responseText=""}),e},x.prototype.addEventProcessor=function(e){this.eventProcessors.push(e)},x.prototype.addBreadcrumb=function(e){!this.options.reportBreadcrumb.console&&"CONSOLE"===e.category||this.findTimeoutReq(e)||(30===di.length&&di.shift(),di.push(e))},x.prototype.updateVideoBreadcrumbs=function(e){this.eventsMatrix=e},x.prototype.findTimeoutReq=function(e){var r=this,o=!1;if(0===this.focusInters.length)return o;var t=e.category,i=e.data;return t!==h.FETCH&&t!==h.XHR||this.focusInters.some(function(e){var t=i.baseUrl.toLowerCase(),n=e.interface.toLowerCase();return-1<t.indexOf(n)&&i.duration>e.threshold&&(r.captureEvent(y({type:m.SLOW_INTERFACE_RESPONSE,title:"接口请求超时: "+i.baseUrl,errorDetail:Gn(i,{threshold:e.threshold})})),o=!0)}),o},x.prototype.captureEvent=function(e){var t=this,n=e;if(this.eventProcessors.forEach(function(e){n=e(n)}),null===n)s.info("Event has been filtered by processor: ",e);else if(this.transport.send(n),this.options.videoStatus)try{var r=this.eventsMatrix.length,o=1===r?this.eventsMatrix[r-1]:this.eventsMatrix[r-2].concat(this.eventsMatrix[r-1]);0===o.length?setTimeout(function(){t.sendVideo(o,n,"delay")},1e3):this.sendVideo(o,n,"now")}catch(e){console.log("不兼容,"+e)}},x.prototype.sendVideo=function(e,t,n){this.transView.sendVideo({data:e,timestamp:t.timestamp,title:t.title,stacktrace:t.stacktrace,type:t.type,project:t.project,delay:n})},x);function x(e){var t=this;this.focusInters=[];this.options=rn({},{project:"",endpoint:"https://watchtower-logger.jd.com",samplingRate:1,reportErrors:{ecmaScriptError:!0,xhrError:!0,jsonpError:!0,fetchError:!0,resourceError:!0,unhandledRejection:!0,lowFps:!0,pageCrash:!1,slowInterResp:!0,custom:!0,videoStatus:!1},reportBreadcrumb:{console:!1}},e),this.eventsMatrix=[[]],this.eventProcessors=[function(e){return e?fi&&fi.type===e.type&&fi.title===e.title?(fi=e,null):fi=e:null},function(e){return e&&Math.random()<=t.options.samplingRate?e:null},function(e){return e&&t.options.reportErrors[pi[e.type]]?e:null},function(e){return e?f(f({},e),{project:t.options.project}):null},function(e){return e?f(f({},e),{breadcrumbs:t.filterBreadcrumbs(di)}):null}],!function(){if(window.navigator.sendBeacon)try{return new Blob,-1!==window.navigator.sendBeacon.toString().indexOf("native")}catch(e){return}}()?this.transport=new H(this.options.endpoint+"/log"):this.transport=new z(this.options.endpoint+"/log"),this.transView=new H(this.options.endpoint+"/logVideo"),this.options.videoStatus&&(new li).install(this),(new On).install(this),(new xn).install(this),(new wn).install(this),(new kn).install(this),(new Mn).install(this),(new Ln).install(this),(new Pn).install(this),(new Un).install(this),(new Yn).install(this),(new Kn).install(this),(new tr).install(this),this.options.reportErrors.pageCrash&&(new sr).install(this),new H(this.options.endpoint+"/api/getInterBySlug").wtAjax({slug:this.options.project}).then(function(e){e.isSuccess&&(t.focusInters=e.data)})}return{init:function(e){window.__watchtower_sensor__||e.project&&(window.__watchtower_sensor__=new hi(e))},catchExp:function(e){var t,n=e.title,r=e.errorDetail,o=e.type,e=e.customKey;n&&window.__watchtower_sensor__&&window.__watchtower_sensor__.captureEvent(y({type:(o=o,(t=new Map).set("ECMASCRIPT_ERROR",m.ECMASCRIPT_ERROR),t.set("XHR_ERROR",m.XHR_ERROR),t.set("RESOURCE_ERROR",m.RESOURCE_ERROR),t.set("UNHANDLEDREJECTION",m.UNHANDLEDREJECTION),t.set("LOW_FPS",m.LOW_FPS),t.set("PAGE_CRASH",m.PAGE_CRASH),t.set("SLOW_INTERFACE_RESPONSE",m.SLOW_INTERFACE_RESPONSE),t.set("FETCH_ERROR",m.FETCH_ERROR),t.set("CUSTOM",m.CUSTOM),o&&t.has(o)?t.get(o):m.CUSTOM),title:"自定义异常: "+n,customKey:e,errorDetail:"[object Object]"===Object.prototype.toString.call(r)?r:{errorDetail:r}}))}}});
/*2022-04-02 15:19:35*/